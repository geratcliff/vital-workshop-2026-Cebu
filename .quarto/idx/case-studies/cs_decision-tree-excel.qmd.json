{"title":"Exercise: Decision Tree in Excel","markdown":{"yaml":{"title":"Exercise: Decision Tree in Excel","format":{"html":{"link-external-newwindow":true}},"editor_options":{"chunk_output_type":"console"},"self-contained":true},"headingText":"Link in Github repo","containsRefs":false,"markdown":"\n\n```{r, echo=FALSE, include=knitr::opts_knit$get('rmarkdown.pandoc.to') == 'html'}\nlibrary(downloadthis)\ndownload_link(\n  link = \"https://graveja0.github.io/bogota-vital-strategies/case-studies/cs1_PE_v1_BLANK.xlsx\",\n  button_label = \"Download Decision Tree Excel File\",\n  button_type = \"primary\",\n  has_icon = TRUE,\n  icon = \"fa fa-save\",\n  self_contained = FALSE\n)\n```\n\n```{=html}\n<style>\n.nobullet li {\n  list-style-type: none;\n}\n</style>\n```\n\n# Introduction and Learning Objectives\n\nThis case study is designed to get you familiar with constructing a decision tree in Excel. Specific learning objectives are as follows:\n\n1.  Parameterize and structure a decision tree model.\n\n2.  Estimate survival and cost outcomes from a decision tree model.\n\n# Overview of Decision Problem\n\nPulmonary embolism (PE) during pregnancy is a life-threatening event. Treatment with anti-coagulation is effective in preventing further PE and hence in reducing the fatality probability.\n\nAnti-coagulation therapy, however, carries a risk of major bleeding (hemorrhage), which can also be fatal. Therefore, avoidance of anti-coagulation is preferred unless absolutely necessary.\n\nOur primary objective is to estimate the expected costs and survival. We will consider a population of 100,000 pregnant women for whom the **probability of an initial PE is 0.19.** To reduce complexity, we will assume that all recurrent PE events result in death.\n\nIn addition,\n\n-   The cost of a fatal recurrent PE/hemorrhage event is 10,000.\n-   The cost of a nonfatal recurrent PE/hemorrhage event is 5,000.\n\nWe will consider two possible strategies to treat these women:\n\n| Strategy                     | Costs                                 | Health Effects                          |\n|--------------------|--------------------------|---------------------------|\n| 1\\. Anticoagulant therapy    | Cost of anticoagulant therapy = 1,000 | Probability of recurrent PE = 0.05     |\n|                              |                                       | Probability of fatal hemorrhage = 0.04 |\n| 2\\. No Anticoagulant therapy |                                       | Probability of recurrent PE = 0.25      |\n\n# Excel-for-CEA: Assigning Variable Names\n\n## Assigning Variable Names\n\nOur first step is to assign each base case value its variable name. There are two ways to do this:\n\n1.  Using the naming box in the upper left of the spreadsheet. This is useful for naming one item at a time.\n2.  Batch naming by using a table selection.\n\nLet's first run through option 1. In the figure below, we will assign the name \"variable1\" to the value in cell C5. We do this using the naming box highlighted in the upper left. Simply replace \"C5\" there with what you want to call the value in that cell, i.e., \"variable1.\"\n\n![Assign the variable name \"variable1\" to the value in cell C5.](images/paste-9EE923C4.png)\n\nYou can see this process in action in the video below.\n\n{{< video src=\"https://www.youtube.com/watch?v=J4h-9OFEnsE\" >}}\n\n## Batch Assigning Variable Names\n\nOften it is more efficient to assign groups of variables, rather than do it one by one. To do this we simply select the \"table\" we want to use, and then go to the `Formulas` tab and select `Create from Selection.`\n\n::: {.callout-important appearance=\"simple\"}\nMake sure the variable name you want to assign is either in the leftmost row, or the top row (see below). Also make sure the value you want assigned to that variable is in the second column, as shown in the figure.\n:::\n\n![](images/paste-B6FE7C65.png)\n\nAssuming you have structured your parameter table as above, and using the guidance above, when excel prompts you to \"Create Names\" you can tell it the variable names are in the left column:\n\n![](images/paste-99B8ACB3.png)\n\nOnce you have done this, you can select the `Name Manager` on the Formulas ribbon to confirm the new names have been assigned, and to make changes.\n\n::: {.callout-important appearance=\"simple\"}\nYou can edit, delete, or reassign the cell values/range in the Name Manager, too.\n:::\n\n![](images/paste-74E2CF5F.png)\n\nA video walk-through of this process is shown below.\n\n{{< video src=\"https://youtu.be/6H7teHB9ElY\" >}}\n\nIf your parameter names are organized as column headers, you can use the same process, as shown in the video below.\n\n{{< video src=\"https://youtu.be/18KwsCoJKyY\" >}}\n\n# Step 1: Parameterize the Decision Problem\n\nThe first worksheet you will find in the Excel case study is called \"parameters.\" This is the worksheet we will use to parameterize the decision tree:\n\n![](images/paste-80B50DF7.png)\n\nRelevant parameter names are already provided for you. However, we now need to fill in the base case values based on the information provided in the \"Overview of Decision Problem\" section above.\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.1\n\n{{< fa file-excel >}} Use variable names to assign values to each parameter in the Excel document.\n:::\n\n# Step 2: Parameterize the Decision Tree\n\nWith our variable names defined we can now populate the tree, which you can find in the worksheet titled \"Decision Tree\" :\n\n![](images/paste-28ED1A14.png)\n\nUnderneath each branch of the tree you will see a blank box; this is where the parameter values will be placed:\n\n![](images/paste-7FDAA39E.png){width=\"500\"}\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.2\n\n{{< fa file-excel >}} Parameterize the decision tree branches using the parameter names you defined in Exercise 1.1.\n:::\n\n::: column-margin\n**HINT**: Some of the decision tree branches will require simple formulas based on the parameter variables. For example, survival is often calculated as (1-Pr(Death)).\n:::\n\n# Step 3: Calculate Outcomes for Each Tree Branch\n\nOur next step is to calculate health and cost outcomes for each branch of the tree. On the far right you will notice three boxes:\n\n![](images/paste-64D89A83.png){width=\"500\"}\n\n-   The **Outcome** column can be used to insert text that describes the outcome for that branch. For example, the first outcome is for a fatal recurrent PE event.\n\n-   The **Cost** column tracks the total costs for an outcome event. In the above example, the cost column should be filled out to reflect the total cost of a fatal recurrent PE event in the event the woman receives anticoagulant therapy.\n\n-   The **Effectiveness (Survival)** column tracks survival outcomes. For the purposes of this case study we are tracking only survival, not quality-adjusted life years. Therefore you can enter a value of \"0\" if the outcome for the given branch is death, and \"1\" if the outcome is survival.\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.3\n\n{{< fa file-excel >}} Fill out the outcomes for each branch of the decision tree. For this exercise, you should fill out all three columns in each row.\n:::\n\n## Step 4: Calculate Expected Outcomes\n\nOur final step is to \"fold-back\" the decision tree to summarize expected cost and survival outcomes for each strategy under consideration. You will find a summary table of outcomes in the worksheet titled \"Summary.\"\n\n![](images/paste-E8AE8F49.png)\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.4\n\n{{< fa file-excel >}} Calculate expected outcomes for each strategy.\n:::\n\n::: column-margin\n**HINT**: For the expected deaths outcome, you can use the total population size and expected survival outcome.\n:::\n","srcMarkdownNoYaml":"\n\n```{r, echo=FALSE, include=knitr::opts_knit$get('rmarkdown.pandoc.to') == 'html'}\nlibrary(downloadthis)\n## Link in Github repo\ndownload_link(\n  link = \"https://graveja0.github.io/bogota-vital-strategies/case-studies/cs1_PE_v1_BLANK.xlsx\",\n  button_label = \"Download Decision Tree Excel File\",\n  button_type = \"primary\",\n  has_icon = TRUE,\n  icon = \"fa fa-save\",\n  self_contained = FALSE\n)\n```\n\n```{=html}\n<style>\n.nobullet li {\n  list-style-type: none;\n}\n</style>\n```\n\n# Introduction and Learning Objectives\n\nThis case study is designed to get you familiar with constructing a decision tree in Excel. Specific learning objectives are as follows:\n\n1.  Parameterize and structure a decision tree model.\n\n2.  Estimate survival and cost outcomes from a decision tree model.\n\n# Overview of Decision Problem\n\nPulmonary embolism (PE) during pregnancy is a life-threatening event. Treatment with anti-coagulation is effective in preventing further PE and hence in reducing the fatality probability.\n\nAnti-coagulation therapy, however, carries a risk of major bleeding (hemorrhage), which can also be fatal. Therefore, avoidance of anti-coagulation is preferred unless absolutely necessary.\n\nOur primary objective is to estimate the expected costs and survival. We will consider a population of 100,000 pregnant women for whom the **probability of an initial PE is 0.19.** To reduce complexity, we will assume that all recurrent PE events result in death.\n\nIn addition,\n\n-   The cost of a fatal recurrent PE/hemorrhage event is 10,000.\n-   The cost of a nonfatal recurrent PE/hemorrhage event is 5,000.\n\nWe will consider two possible strategies to treat these women:\n\n| Strategy                     | Costs                                 | Health Effects                          |\n|--------------------|--------------------------|---------------------------|\n| 1\\. Anticoagulant therapy    | Cost of anticoagulant therapy = 1,000 | Probability of recurrent PE = 0.05     |\n|                              |                                       | Probability of fatal hemorrhage = 0.04 |\n| 2\\. No Anticoagulant therapy |                                       | Probability of recurrent PE = 0.25      |\n\n# Excel-for-CEA: Assigning Variable Names\n\n## Assigning Variable Names\n\nOur first step is to assign each base case value its variable name. There are two ways to do this:\n\n1.  Using the naming box in the upper left of the spreadsheet. This is useful for naming one item at a time.\n2.  Batch naming by using a table selection.\n\nLet's first run through option 1. In the figure below, we will assign the name \"variable1\" to the value in cell C5. We do this using the naming box highlighted in the upper left. Simply replace \"C5\" there with what you want to call the value in that cell, i.e., \"variable1.\"\n\n![Assign the variable name \"variable1\" to the value in cell C5.](images/paste-9EE923C4.png)\n\nYou can see this process in action in the video below.\n\n{{< video src=\"https://www.youtube.com/watch?v=J4h-9OFEnsE\" >}}\n\n## Batch Assigning Variable Names\n\nOften it is more efficient to assign groups of variables, rather than do it one by one. To do this we simply select the \"table\" we want to use, and then go to the `Formulas` tab and select `Create from Selection.`\n\n::: {.callout-important appearance=\"simple\"}\nMake sure the variable name you want to assign is either in the leftmost row, or the top row (see below). Also make sure the value you want assigned to that variable is in the second column, as shown in the figure.\n:::\n\n![](images/paste-B6FE7C65.png)\n\nAssuming you have structured your parameter table as above, and using the guidance above, when excel prompts you to \"Create Names\" you can tell it the variable names are in the left column:\n\n![](images/paste-99B8ACB3.png)\n\nOnce you have done this, you can select the `Name Manager` on the Formulas ribbon to confirm the new names have been assigned, and to make changes.\n\n::: {.callout-important appearance=\"simple\"}\nYou can edit, delete, or reassign the cell values/range in the Name Manager, too.\n:::\n\n![](images/paste-74E2CF5F.png)\n\nA video walk-through of this process is shown below.\n\n{{< video src=\"https://youtu.be/6H7teHB9ElY\" >}}\n\nIf your parameter names are organized as column headers, you can use the same process, as shown in the video below.\n\n{{< video src=\"https://youtu.be/18KwsCoJKyY\" >}}\n\n# Step 1: Parameterize the Decision Problem\n\nThe first worksheet you will find in the Excel case study is called \"parameters.\" This is the worksheet we will use to parameterize the decision tree:\n\n![](images/paste-80B50DF7.png)\n\nRelevant parameter names are already provided for you. However, we now need to fill in the base case values based on the information provided in the \"Overview of Decision Problem\" section above.\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.1\n\n{{< fa file-excel >}} Use variable names to assign values to each parameter in the Excel document.\n:::\n\n# Step 2: Parameterize the Decision Tree\n\nWith our variable names defined we can now populate the tree, which you can find in the worksheet titled \"Decision Tree\" :\n\n![](images/paste-28ED1A14.png)\n\nUnderneath each branch of the tree you will see a blank box; this is where the parameter values will be placed:\n\n![](images/paste-7FDAA39E.png){width=\"500\"}\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.2\n\n{{< fa file-excel >}} Parameterize the decision tree branches using the parameter names you defined in Exercise 1.1.\n:::\n\n::: column-margin\n**HINT**: Some of the decision tree branches will require simple formulas based on the parameter variables. For example, survival is often calculated as (1-Pr(Death)).\n:::\n\n# Step 3: Calculate Outcomes for Each Tree Branch\n\nOur next step is to calculate health and cost outcomes for each branch of the tree. On the far right you will notice three boxes:\n\n![](images/paste-64D89A83.png){width=\"500\"}\n\n-   The **Outcome** column can be used to insert text that describes the outcome for that branch. For example, the first outcome is for a fatal recurrent PE event.\n\n-   The **Cost** column tracks the total costs for an outcome event. In the above example, the cost column should be filled out to reflect the total cost of a fatal recurrent PE event in the event the woman receives anticoagulant therapy.\n\n-   The **Effectiveness (Survival)** column tracks survival outcomes. For the purposes of this case study we are tracking only survival, not quality-adjusted life years. Therefore you can enter a value of \"0\" if the outcome for the given branch is death, and \"1\" if the outcome is survival.\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.3\n\n{{< fa file-excel >}} Fill out the outcomes for each branch of the decision tree. For this exercise, you should fill out all three columns in each row.\n:::\n\n## Step 4: Calculate Expected Outcomes\n\nOur final step is to \"fold-back\" the decision tree to summarize expected cost and survival outcomes for each strategy under consideration. You will find a summary table of outcomes in the worksheet titled \"Summary.\"\n\n![](images/paste-E8AE8F49.png)\n\n::: {.callout-tip appearance=\"simple\"}\n## Exercise 1.4\n\n{{< fa file-excel >}} Calculate expected outcomes for each strategy.\n:::\n\n::: column-margin\n**HINT**: For the expected deaths outcome, you can use the total population size and expected survival outcome.\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"self-contained":true,"output-file":"cs_decision-tree-excel.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","theme":"cosmo","title":"Exercise: Decision Tree in Excel","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}