{"title":"Incremental Cost-Effectiveness Analysis","markdown":{"yaml":{"title":"Incremental Cost-Effectiveness Analysis","format":{"revealjs":{"theme":"slides.scss","incremental":false,"slide-number":true,"logo":"../vchem.png","html-math-method":"katex","transition":"fade","background-transition":"fade","highlight-style":"ayu-mirage","footer":"[Back to Website](../index.html)\n"}},"editor_options":{"chunk_output_type":"console"},"editor":{"markdown":{"wrap":72}}},"headingText":"Learning Objectives and Outline","containsRefs":false,"markdown":"\n\n```{r, echo = FALSE}\nlibrary(tidyverse)\nlibrary(DiagrammeR)\nlibrary(here)\nlibrary(glue)\nlibrary(Matrix)\nlibrary(expm)\nlibrary(ggrepel)    # For plotting\nlibrary(ellipse)    # For plotting\nlibrary(scales)     # For dollar signs and commas\nlibrary(randtoolbox)\nlibrary(igraph)\nlibrary(tidygraph)\nlibrary(ggraph)\nlibrary(progress)\nlibrary(hrbrthemes)\nlibrary(ggsci)\nlibrary(directlabels)\nlibrary(gt)\nlibrary(ggpmisc)\nlibrary(kableExtra)\nlibrary(knitr)\noptions(knitr.kable.NA = '') \n```\n\n```{=html}\n<style>\n.nobullet li {\n  list-style-type: none;\n}\n</style>\n```\n\n```{r, echo = FALSE}\n\nsource(\"./functions_healthy-sick-dead.r\")\n\ntheme_cea<- function(base_size = 11, base_family = \"Gill Sans\", ticks = TRUE) {\n  \n  ret <- ggplot2::theme_bw(base_family = base_family, base_size = base_size) +\n    ggplot2::theme(\n      axis.line = ggplot2::element_blank(),\n      axis.title.x = ggplot2::element_text(vjust = -0.3),\n      axis.title.y = ggplot2::element_text(vjust = 0.8),\n      legend.background = ggplot2::element_blank(),\n      legend.key = ggplot2::element_blank(),\n      legend.title = ggplot2::element_text(face=\"plain\"),\n      panel.background = ggplot2::element_blank(),\n      panel.border = ggplot2::element_blank(),\n      panel.grid = ggplot2::element_blank(),\n      plot.background = ggplot2::element_blank(),\n      strip.background = ggplot2::element_blank()\n    )\n  \n  if (!ticks) {\n    ret <- ret + ggplot2::theme(axis.ticks = ggplot2::element_blank())\n  }\n  \n  ret\n}\n\nload(\"./data/df_cea.RData\")\n\ndf <- \n  df_cea %>% \n  select(Cost, Effect) %>% \n  rownames_to_column(var= \"strategy\") %>% \n  select(strategy, everything()) \n\ndf_s <- \n  df_cea %>% \n  arrange(Cost) %>% \n  select(Cost, Effect) %>% \n  rownames_to_column(var= \"strategy\") %>% \n  select(strategy, everything())\n\ndf_i1 <-\n  df_cea %>%\n  rownames_to_column(var= \"strategy\") %>% \n  select(strategy, everything()) %>% \n  arrange(Cost) %>%\n  mutate(d_cost = round(Cost - lag(Cost),0),\n         d_effect = round(Effect - lag(Effect),3)) %>%\n  select(strategy, Cost, d_cost ,Effect, d_effect)\n\ndf_i2 <- \n  df_i1 %>% \n  mutate(icer = d_cost / d_effect) %>% \n  mutate(status = case_when(icer<0 ~ \"Dominated\",\n                            TRUE ~ \"\" )) \n\ndf_i3 <- \n  df_i2 %>% \n  #filter(status != \"Dominated\") %>% \n  arrange(status,Cost) %>%\n mutate(d_cost = round(Cost - lag(Cost),0),\n         d_effect = round(Effect - lag(Effect),3)) %>%\n  mutate(icer = d_cost / d_effect) %>% \n  mutate(icer = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, icer)) %>% \n  mutate(d_cost = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_cost)) %>% \n  mutate(d_effect = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_effect)) %>% \n  mutate(status = case_when(!is.na(icer) & icer<0 ~ \"Dominated\",\n                             !is.na(icer) & icer > lead(icer) & lead(status) != \"Dominated\" ~ \"Dominated (Extended)\",\n                             TRUE ~ status))\n\ndf_i4 <- \n  df_i3 %>% \n  arrange(status, Cost) %>% \n  mutate(d_cost = round(Cost - lag(Cost),0),\n         d_effect = round(Effect - lag(Effect),3)) %>%\n  mutate(icer = d_cost / d_effect) %>% \n  mutate(icer = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, icer)) %>% \n  mutate(d_cost = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_cost)) %>% \n  mutate(d_effect = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_effect)) %>% \n  \n  mutate(status = case_when(!is.na(icer) & icer<0 ~ \"Dominated\",\n                             !is.na(icer) & icer > lead(icer) & lead(status) != \"Dominated\" ~ \"Dominated (Extended)\",\n                             TRUE ~ status))\n                            \n\n```\n\n\n## Learning Objectives\n\n-   Differentiate between average & incremental CEA ratios\n\n-   Characterize decision problems by whether they are competing or\n    non-competing\n\n-   Compute and interpret ICERs\n\n-   Practice ruling out \"dominated\" and \"extendedly dominated\"\n    strategies\n\n-   Identify \"high-value\" versus \"low value\" care strategies, based on\n    generally accepted cost-effectiveness thresholds\n\n## Outline\n\n<br>\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Review of CEA ratio\n2.  Non-competing versus competing CEAs\n3.  Incremental CEA\n:::\n\n::: {.column width=\"50%\"}\n4.  Dominance & extended dominance\n5.  Comparators\n6.  CEA thresholds\n:::\n:::\n\n# Cost-Effectiveness Analysis {background=\"#43464B\"}\n\n## Cost-Effectiveness Analysis\n\n::: incremental\n-   Quantifies how to maximize the quality & quantity of life from among\n    competing alternatives, given restricted resources\n\n-   It's an explicit measure of value for money\n\n-   A POPULATION-LEVEL decision-making tool\n:::\n\n## Cost-Effectiveness Analysis IS NOT\n\n::: incremental\n-   Indiscriminate cost-cutting\n-   Downsizing\n-   For individual-level decision making\n-   The only tool for decision-making\n:::\n\n## Cost-Effectiveness Analysis {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: {data-id=\"costA\"}\nCost of Intervention\n:::\n\n::: {data-id=\"costB\"}\nCost of Alternative\n:::\n\n::: {data-id=\"benefitA\"}\nBenefit of Intervention\n:::\n\n::: {data-id=\"benefitB\"}\nBenefit of Alternative\n:::\n:::\n\n## Cost-Effectiveness Analysis {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\nCost of Intervention\n:::\n\n::: {data-id=\"costB\" style=\"color: #B98476;\"}\nCost of Alternative\n:::\n\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\nBenefit of Intervention\n:::\n\n::: {data-id=\"benefitB\" style=\"color: #3FA090;\"}\nBenefit of Alternative\n:::\n:::\n\n## Cost-Effectiveness Ratio {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: r-hstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\nCost of Intervention\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"costB\" style=\"color: #B98476;\"}\nCost of Alternative\n:::\n:::\n\n$$\\frac{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}$$\n\n::: r-hstack\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\nBenefit of Intervention\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"benefitB\" style=\"color: #3FA090;\"}\nBenefit of Alternative\n:::\n:::\n:::\n\n## Cost-Effectiveness Ratio {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: r-hstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\n$C_1$\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"costB\" style=\"color: #B98476;\"}\n$C_0$\n:::\n:::\n\n$$\\frac{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}$$\n\n::: r-hstack\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\n$E_0$\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"benefitB\" style=\"color: #3FA090;\"}\n$E_1$\n:::\n:::\n:::\n\n## Cost-Effectiveness Ratio {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: r-hstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\n$\\Delta C$\n:::\n:::\n\n$$\\frac{\\quad \\quad \\quad \\quad }{\\quad \\quad \\quad \\quad \\quad }$$\n\n::: r-hstack\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\n$\\Delta E$\n:::\n:::\n:::\n\n## Incremental Cost-Effectiveness Ratio {.smaller}\n\n**Most often used, since for most conditions there is already some\navailable treatment.**\n\n::: incremental\n::: columns\n::: {.column width=\"50%\"}\n-   $C_1$: net present value of total lifetime costs of new treatment\n-   $C_0$: net present value of total lifetime costs of default\n    treatment\n-   $E_1$: effectiveness of new treatment, measured in expected life\n    expectancy, quality-adjusted life years (QALYs) or\n    disability-adjusted life years (DALYs), or some decision-relevant\n    health outcome.\n-   $E_0$: effectiveness of default treatment\n:::\n\n::: {.column width=\"50%\"}\n::: {style=\"padding-top: 100px;\"}\n$$\n\\frac{C_1 - C_0 \\quad  (\\Delta C)}{E_1 - E_0 \\quad  (\\Delta E)}\n$$\n:::\n:::\n:::\n:::\n\n<!-- # Example: Neurologic Disease -->\n\n<!-- ## Neurologic Disease Decision Tree -->\n\n<!-- - Consider a neurologic disease that blocks a certain cell receptor in the brain.  -->\n\n<!-- - If left untreated, the disease is lethal for 50 out of every 1,000 people. -->\n\n<!-- ## Neurologic Disease Decision Tree -->\n\n<!-- - A hypothetical new treatment reduces the mortality rate to to 15 out of every 1,000, but only among people with the certain cell receptor.  -->\n\n<!-- - Among people without the receptor, the treatment confers a 1% probability of death.  -->\n\n<!-- ## Neurologic Disease Decision Tree -->\n\n<!-- - Rather than treat none or treat all suspected with the disease, a biopsy option is available. -->\n\n<!-- - TK -->\n\n\n## Neurologic Disease Decision Tree\n\n\n![](images/cea-example1.png)\n\n## Outcomes\n\n-   $C_{treat}$ = expected cost of treat everyone strategy.\n-   $C_{no treat}$ = expected cost of treat *no one* strategy.\n-   $C_{biopsy}$ = expected cost of biopsy strategy.\n\n## Outcomes\n\n-   $C_{treat}$ = expected cost of treat everyone strategy.\n-   $C_{no treat}$ = expected cost of treat *no one* strategy.\n-   $C_{biopsy}$ = expected cost of biopsy strategy.\n-   $E_{treat}$ = expected life expectancy of treat everyone strategy.\n-   $E_{no treat}$ = expected expectancy of treat *no one* strategy.\n-   $E_{biopsy}$ = expected expectancy of biopsy strategy.\n\n## Outcomes in Amua\n\n![](images/outcomes-amua.png){fig-align=\"center\"}\n\n## Treat All vs. Treat None\n\nStrategy: Treat No One ![](images/cea-example2.png)\n\n## Treat All vs. Treat None\n\nStrategy: Treat All ![](images/cea-example3.png)\n\n## Key Takeaways (For Now)\n\n::: incremental\n-   Treatment yields *higher* life expectancy for those with disease,\n    but comes at a cost.\n-   Treatment yields *lower* life expectancy for those without the\n    disease, *and also* comes at a cost.\n-   Biopsy can help balance these two outcomes by better targeting\n    treatment, but also comes with costs and risks.\n-   Incremental CEA provides a transparent framework for quantifying and\n    weighing these considerations.\n:::\n\n## Average Cost-Effectiveness Ratio {.smaller}\n\n**Special case where** $C_0$ and $E_0$ are assumed to be zero.\n\n::: columns\n::: {.column width=\"50%\"}\n-   $C_1$: net present value of total lifetime costs of new treatment\n-   $C_0$: Assumed zero\n-   $E_1$: effectiveness of new treatment, measured in expected life\n    expectancy, quality-adjusted life years (QALYs) or\n    disability-adjusted life years (DALYs), or some decision-relevant\n    health outcome.\n-   $E_0$: Assumed zero\n:::\n\n::: {.column width=\"50%\"}\n::: {style=\"padding-top: 50px;\"}\n$$\n\\begin{aligned}\nICER &=  \\frac{C_1 - 0}{E_1 - 0} \\\\\n &= \\frac{C_1}{E_1 }\n\\end{aligned}\n$$\n:::\n:::\n:::\n\n# Non-Competing vs. Competing CEAs {background=\"#43464B\"}\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n1.  **Shopping Spree**: Decision problem has non-competing\n    programs/interventions.\n\n-   Each program is compared to a null alternative; therefore, you're\n    calculating an \"average\" cost-effectiveness ratio.\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n2.  **Competing Choice**: Decision problem has competing\n    programs/interventions for the same purpose; these choices are\n    mutually exclusive.\n\n-   Two or more active alternatives in addition to the null option.\n-   You need to calculate an \"incremental cost- effectiveness ratio\",\n    which gives us the added cost per unit of added benefit of an\n    option, relative to the next less expensive choice\n\n## Non-Competing (Shopping Spree) Decision Problem\n\n**How can we measure the relative priority of various health programs\nthat compete for limited resources?**\n\n::: incremental\n1.  Cardiovascular disease program\n2.  Safe motherhood program\n3.  HIV prevention initiative\n4.  Child vaccination\n5.  Depression screening\n:::\n\n## Assumptions\n\n::: incremental\n-   Program alternatives are assumed to be independent\n-   Budget constraint is only limitation\n-   Neither the net cost nor the net effectiveness depend on what other\n    programs are selected\n-   Programs are assumed to be divisible \\[programs can be partially\n    implemented\\]\\\n:::\n\n## Objectives: Shopping Spree Problem {background=\"#c2f0c2\"}\n\n#### {{< fa circle-check >}} Maximize the total net effectiveness (health benefit) of the programs selected.\n\n#### {{< fa circle-check >}} Stay within budget.\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\nStep 1: - Rule out programs that cost \\$ but have negative health\neffects <br> - Dominated by alternative of \"no program\"\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n#| fig-width: 8\n#| fig-align: center\n\ndf_ex <- \n  tibble(\n  program = LETTERS[1:8],\n  cost = c(27,30,56,20,30,50,40,-20),\n  qalys = c(30,20,70,40,50,75,-30,20)\n  ) %>% \n  mutate(type = case_when(cost > 0 & qalys <0 ~ \"cp_en\",\n                          cost <0  & qalys > 0 ~ \"cn_ep\",\n                          cost >0 & qalys > 0 ~ \"cp_ep\")) %>% \n  mutate(label = case_when(type == \"cp_en\" ~ \"Less effective\\nmore costly\",\n                           type == \"cn_ep\" ~ \"More effective\\nless costly\",\n                           type == \"cp_ep\" ~ \"More effective\\nmore costly\"))\n\n  df_ex %>% \n    filter(type %in% c(\"cp_en\")) %>% \n    ggplot(aes(x = qalys, y = cost)) + \n    theme_cea() + \n    geom_point(size=6, aes(pch=type,colour = type)) +\n    geom_quadrant_lines(linetype = \"solid\") +\n    #hrbrthemes::theme_ipsum(base_size=16) + \n    theme(axis.title.x = ggplot2::element_text( size=24, angle=0),\n          axis.title.y = ggplot2::element_text(size = 24,angle=1)) + \n    scale_x_continuous(limits = c(-max(abs(df_ex$qalys)),max(abs(df_ex$qalys))), breaks = NULL , position=\"top\") + \n    scale_y_continuous(limits = c(-max(abs(df_ex$cost)),max(abs(df_ex$cost))), breaks = NULL ,position = \"right\") +\n    labs(x = \"Incremental Costs\", y = \"Incremental Health\") + \n    geom_dl(method = list(\"smart.grid\",hjust=.9,cex=2,vjust=1),aes(label = glue(\"{label}\"))) +\n    theme(legend.position =\"none\") +\n    scale_shape_manual(values = c(4)) + \n    scale_colour_manual(values = c(\"red\")) + \n    geom_label(aes(label=program),size=10)\n\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\nStep 2:\\\n- Select programs that are cost-saving & offer benefit; net savings can\nalso be added to budget <br> - Cost-saving compared to alternative of no\nprogram\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n#| fig-width: 8\n#| fig-align: center\n\n  df_ex %>% \n  filter(type %in% c(\"cp_en\",\"cn_ep\")) %>% \n  ggplot(aes(x = qalys, y = cost)) + \n  theme_cea() + \n  geom_point(size=6, aes(pch=type,colour = type)) +\n  geom_quadrant_lines(linetype = \"solid\") +\n  #hrbrthemes::theme_ipsum(base_size=16) + \n  theme(axis.title.x = ggplot2::element_text( size=24, angle=0),\n        axis.title.y = ggplot2::element_text(size = 24,angle=1)) + \n  scale_x_continuous(limits = c(-max(abs(df_ex$qalys)),max(abs(df_ex$qalys))), breaks = NULL , position=\"top\") + \n  scale_y_continuous(limits = c(-max(abs(df_ex$cost)),max(abs(df_ex$cost))), breaks = NULL ,position = \"right\") +\n  labs(x = \"Incremental Costs\", y = \"Incremental Health\") + \n  geom_dl(method = list(\"smart.grid\",hjust=.9,cex=2,vjust=1),aes(label = glue(\"{label}\"))) +\n  theme(legend.position =\"none\") +\n  scale_shape_manual(values = c(19,4,3)) + \n  scale_colour_manual(values = c(\"darkgreen\",\"red\",\"blue\")) + \n  geom_label(aes(label=program),size = 10)\n\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\nStep 3:\\\n- Rank other programs in ascending order by their cost-effectiveness\nratio (lowest to highest) <br> - Programs are then selected from the\nLEAST to the MOST expensive until the budget is expended <br> - Final\narray of programs selected will depend on the budget constraint\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n#| fig-width: 5\n#| fig-align: center\n\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\"))) %>% \n  ggplot(aes(x = qalys, y = cost)) + \n\n  #geom_point(size=6, aes(pch=type,colour = type)) +\n  geom_quadrant_lines(linetype = \"solid\") +\n  #hrbrthemes::theme_ipsum(base_size=16) + \n    geom_label(aes(label=program), colour = \"black\") + \n  theme(axis.title.x = ggplot2::element_text( size=24, angle=0),\n        axis.title.y = ggplot2::element_text(size = 24,angle=1)) + \n  scale_x_continuous(limits = c(-max(abs(df_ex$qalys)),max(abs(df_ex$qalys))), breaks = NULL , position=\"top\") + \n  scale_y_continuous(limits = c(-max(abs(df_ex$cost)),max(abs(df_ex$cost))), breaks = NULL ,position = \"right\") +\n  labs(x = \"Incremental Costs\", y = \"Incremental Health\") + \n  #geom_dl(method = list(\"first.points\",hjust=2,cex=2),aes(label = glue(\"{program}\"))) +\n  theme(legend.position =\"none\") +\n  scale_shape_manual(values = c(3))  + \n  theme_cea() \n  #scale_colour_manual(values = c(\"blue\")) \n\n\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\nSteps 1 & 2: Rule out dominated options & select cost-saving\ninterventions <br>\n\n```{r}\ncolor.me.red <- which(df_ex$type == \"cp_en\")\ncolor.me.green <- which(df_ex$type == \"cn_ep\")\n\ndf_ex %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,status) %>% kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"Status\"),format.args = list(big.mark = \",\")) %>% \n    kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\ndf_ex_excl <- \n  df_ex %>%\n  mutate(status = case_when(type==\"cp_en\" ~ \"Higher Costs, Worse Health\",\n                            type==\"cn_ep\" ~ \"Lower Costs, Better Health\")) %>% \n         \n         select(program,cost,qalys,status) %>% \n  na.omit()\n```\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\n-   Initial budget: \\$80\n-   Budget savings: [\\$20]{style=\"color: #a8d4a7;\"}.\n-   Total budget: \\$80 + [\\$20]{style=\"color: #a8d4a7;\"} = \\$100\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n\ncolor.me.red <- which(df_ex$type == \"cp_en\")\ncolor.me.green <- which(df_ex$type == \"cn_ep\")\n\ndf_ex %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,status) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"Status\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\n-   Calculate average cost-effectiveness ratio.\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2))\n\ncolor.me.red <- which(df_ex_$type == \"cp_en\")\ncolor.me.green <- which(df_ex_$type == \"cn_ep\")\n\ndf_ex_ %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,ce) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n-   Calculate average cost-effectiveness ratio.\n-   Sort (by C/E) in ascending order .\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2)) %>% \n  arrange(ce)\n\ncolor.me.red <- which(df_ex_$type == \"cp_en\")\ncolor.me.green <- which(df_ex_$type == \"cn_ep\")\n\ndf_ex_ %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,ce) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n:::\n:::\n\n::: notes\n-   We want to order the RATIOS from lowest to highest for budget\n    inclusion SINCE lower means we are gaining QALYs more efficiently --\n    or gaining more benefit per dollar spent on care \\*\\*\\*\\*\\*\n:::\n\n## Shopping Spree Problem\n\n::: incremental\n-   Calculate cumulative costs\n-   Determine what is adoptable based on global budget constraint\n    (\\$100)\n-   Calculate cumulative effects (QALYs)\n:::\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$100\n\n```{r}\n\nbudget <- 100\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2)) %>% \n  arrange(ce) %>% \n  mutate(cumcost = cumsum(cost)) %>%\n  mutate(cumeffect=cumsum(qalys)) %>% \n  mutate(in_budget = as.integer(cumcost<=budget))\n\ncolor.me.red <- which(df_ex_$in_budget==0)\ncolor.me.green <- which(df_ex_$in_budget == 1)\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"Out of Budget\",\n                            in_budget==1 ~ \"Within Budget\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) #%>% \n  # kableExtra::kable_styling() %>%\n  # kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  # kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$100\n\n```{r}\n\ncolor.me.red <- which(df_ex_$in_budget==0)\ncolor.me.green <- which(df_ex_$in_budget == 1)\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n\n```{r}\ndf_ex_[color.me.green,] %>% \n  bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  mutate(Budget = budget) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n::: notes\n(1) If we have a budget of \\$100, then based on our program options, we\n    could fund program D, E, & F -- with a cumulative cost of \\$100\n\n(2) Total health benefit would include on average, 165 quality-adjusted\n    life years gained from these programs together\n\n(3) & we might then say that our cost effectiveness threshold would be\n    at \\$0.667 per QALY gained -- \\*\\* this represents the point at\n    which the budget is \"optimally\" allocated given budget constraints\n\n(4) More on thresholds later\n:::\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$150\n\n```{r}\n\nbudget = 150\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2)) %>% \n  arrange(ce) %>% \n  mutate(cumcost = cumsum(cost)) %>%\n  mutate(cumeffect=cumsum(qalys)) %>% \n  mutate(in_budget = as.integer(cumcost<=budget))\n\n\ncolor.me.red <- which(df_ex_$in_budget==0)\ncolor.me.green <- which(df_ex_$in_budget == 1)\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n\n```{r}\ndf_ex_[color.me.green,] %>% \n    bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost,na.rm=TRUE), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  mutate(Budget = budget) %>% \n  mutate(Remaining = budget - Cost) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$150\n\n```{r}\ncolor.me.red <- which(df_ex_$in_budget==0)[-1]\ncolor.me.green <- which(df_ex_$in_budget == 1)\ncolor.me.yellow <- which(df_ex_$in_budget==0)[1]\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\") %>% \n  kableExtra::row_spec(color.me.yellow, bold = T, color = \"black\", background = \"#e3df74\")\n\n```\n\n```{r}\ndf_ex_[color.me.green,] %>% \n    bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost,na.rm=TRUE), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  mutate(Budget = budget) %>% \n  mutate(Remaining = budget - Cost) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$150\n\n```{r}\ndf_ex_ %>% \n  mutate(diff = pmax(0,cumcost-budget)) %>% \n  mutate(test = (cost-diff)/cost) %>% \n  mutate(program = ifelse(diff==0 ,program,\n                          ifelse((cost-diff)/cost>0,\n                                 paste0(program,\" (\",round(100*(cost-diff)/cost,1),\"%)\"),program))) %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\") %>% \n  kableExtra::row_spec(color.me.yellow, bold = T, color = \"black\", background = \"#e3df74\")\n\n```\n\n```{r}\ndf_ex_[c(color.me.green,color.me.yellow),]  %>% \n  mutate(diff = pmax(0,cumcost-budget)) %>% \n  mutate(program = ifelse(diff==0,program,paste0(program,\" (\",round(100*(cost-diff)/cost,1),\"%)\"))) %>% \n  mutate(cost = cost *(cost-diff)/cost) %>% \n  mutate(qalys = qalys * (cost-diff)/cost) %>% \n  mutate(cumcost = cumsum(cost),cumeffect=cumsum(qalys)) %>% \n  bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost,na.rm=TRUE), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  \n  #summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost), Effect = sum(qalys), Threshold = max(ce)) %>% \n  mutate(Budget = budget) %>% \n  mutate(Remaining = budget - Cost) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n::: {style=\"font-size: 0.8em\"}\n-   \\$50 left but program C costs \\$56 (50/56 = 0.89)\n-   0.89\\*70 QALYs of program C = 62.3 QALYs\n:::\n\n## Summary: Shopping Spree Problem\n\n#### {{< fa circle-check >}} Maximize the total net effectiveness (health benefit)\n\n#### {{< fa circle-check >}} Stay within budget\n\n#### {{< fa note-sticky >}} Can do the same with other objectives (e.g., Minimize costs, subject decision to 'minimum benefit' constraint, etc.)\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n::: {.fragment .highlight-grey}\n1.  **Shopping Spree**: Decision problem has non-competing\n    programs/interventions.\n:::\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n2.  **Competing Choice**: Decision problem has competing\n    programs/interventions for the same purpose; these choices are\n    mutually exclusive.\n\n## Objectives: Competing Choice Problem {background=\"#c2f0c2\"}\n\n#### {{< fa circle-check >}} Cannot implement more than one strategy at a time.\n\n#### {{< fa circle-check >}} Incremental cost-effectiveness ratio is below a pre-specified adoption threshold.\n\n## What's different?\n\n::: columns\n::: {.column width=\"50%\"}\n**Shopping Spree**\n\n1.  Can select multiple programs\n2.  Different costs & effects associated with each\n3.  Requires calculation of an *Average Cost-Effectiveness Ratio*\n:::\n\n::: {.column width=\"50%\"}\n**Competing Choice**\n\n1.  [Programs are mutually exclusive.]{style=\"color: red;\"}\n2.  Different costs & effects associated with each.\n3.  [Requires calculation of an *Incremental Cost-Effectiveness Ratio*\n    (ICER)]{style=\"color: red;\"}\n:::\n:::\n\n::: notes\n\\(1\\) Opioid pharmacotherapy is the recommended treatment for OUD in\npregnancy, as we know that medication reduces the risk of overdose and\nrelapse, improves overall retention to care, and improves pregnancy &\nfetal outcomes.\n\n(2) There are three classes of medications approved by the FDA -- &\n    there are several sub-modalities that are not listed here that we\n    are modeling -- such as injectable formulations versus monotherapy /\n    etc.\n\n(3) But overall -- there are options like Methadone that are full\n    \"agonists\" -- where the effects of the treatment increase as the\n    dose increases\n\n(4) Buprenorphine which is a partial agonist -- in other words,\n    buprenorphine has a \"ceiling effect\", so its effects can only be\n    felt up to a certain point & then plateaus thereafter\n\n(5) And Naltrexone, which is an \"antagonist\" and works by blocking\n    opioid receptors & reduces & suppresses opioid cravings\n\n(6) The difficult tradeoffs of these therapies, include:\n\n-   Access challenges & delays in care -- for instance, there's a\n    limited \\# of methadone clinics across the US -- there are only 3\n    methadone clinics in Nashville (22 total in the state) & 5 total in\n    neighboring Mississippi\n\n-   & while buprenorphine & naltrexone, for example, can be administered\n    in any office-based setting, methadone can only be dispensed in\n    these specialty OTP clinics that I had mentioned earlier\n\n-   For opioid recurrence or disengagement from treatment rates,\n    Methadone may have better outcomes BUT methadone also poses a\n    significant risk of mortality from opioid overdose due to\n    respiratory depression during treatment induction\n\n-   Regarding infant outcomes, buprenorphine has performed better than\n    methadone when it comes to outcomes like preterm birth, neonatal\n    withdrawal syndrome, & length of hospital stay, but infants exposed\n    to Naltrexone have the least severe withdrawal overall & lowest\n    hospital length of stay\n\n-   There are also different tradeoffs associated with treatment\n    modalities such as tablets, film, injectables\n\n-   And then there's many other things to consider such as inpatient\n    versus outpatient induction periods versus continuation of care AND\n    outcomes associated with injection versus non-injection users\n\n(7) While individuals can switch back & forth between these medications,\n    they can only be on ONE medication at a time & we have to decide\n    what is the best option for pregnant invidivudals with OUD given all\n    of the tradeoffs just mentioned\n:::\n\n# Incremental CEA {background=\"black\"}\n\n# 1. Incremental CEA in Pictures\n\n## 1. Calculate incremental costs and effects\n\n::: incremental\n-   Often, a strategy capturing current practice ('status-quo', 'do\n    nothing', 'natural history') is defined.\n-   Costs and effects are then calculated for each strategy relative to\n    the status-quo.\n-   Plot the difference in costs and effects with health effects on\n    x-axis and cost effects on y-axis.\n:::\n\n## 1. Calculate cost and effects {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer1.png){fig-align=\"center\"}\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: nonincremental\n-   We can rule out any strategies that result in less health at higher\n    cost.\n:::\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer2.png){fig-align=\"center\"}\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   We can also rule out strategies where *some other competing\n    strategy* results in more (or equal) health at lower (or equal)\n    cost.\n-   This is known as \"strong\" dominance.\n:::\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer3.png){fig-align=\"center\"}\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer4.png){fig-align=\"center\"}\n\n## What about strategy B? {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer5.png){fig-align=\"center\"}\n\n## Hybrid Strategies\n\n::: incremental\n-   Suppose it is feasible to partially implement strategies **A** and\n    **D**.\n    -   For example, we could implement **A** for 90% of the population\n        and **D** for 10% of the population, or vice versa.\n:::\n\n## 90% A, 10% D\n\n![](images/vis_icer6a.png){fig-align=\"center\"}\n\n## 10% A, 90% D\n\n![](images/vis_icer6b.png){fig-align=\"center\"}\n\n## 50% A, 50% D {.smaller auto-animate=\"true\"}\n\n-   Can we make any statements about **B** now?\n\n![](images/vis_icer6c.png){fig-align=\"center\"}\n\n## Extended (Weak) Dominance {.smaller auto-animate=\"true\"}\n\n-   **B** is ruled out by extended (\"weak\") dominance.\n\n![](images/vis_icer7.png){fig-align=\"center\"}\n\n## Extended (Weak) Dominance {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer8.png){fig-align=\"center\"}\n\n## Efficiency Frontier {.smaller auto-animate=\"true\"}\n\n::: nonincremental\n-   The efficiency frontier is the set of non-dominated strategies.\n:::\n\n![](images/vis_icer9.png){fig-align=\"center\"}\n\n## ICERs {.smaller auto-animate=\"true\"}\n\n-   The slope of a line connecting two points is the incremental\n    cost-effectiveness ratio comparing those strategies. More on this\n    later!\n\n![](images/vis_icer10.png){fig-align=\"center\"}\n\n# 2. Incremental CEA in Tables\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n</br> </br> </br> </br> </br>\n\n::: {.callout-important appearance=\"simple\"}\nPlease note that the following example uses different strategies and\nvalues than the example used in the previous pictures!\n:::\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: incremental\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^1]\n\n3.  Calculate ICER based on difference in costs and effects.\n\n4.  Determine dominated strategies (ICER\\<0).\n\n5.  Re-calculate ICERs after eliminating dominated strategies.\n\n6.  Determine strategies ruled out by extended dominance.\n\n7.  Re-calculate ICERs after ruling out all dominated strategies.\n\n8.  Repeat 5-7 as needed.\n:::\n\n[^1]: Least costly first, most costly last\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n[1. Calculate costs and effects for each strategy.]{.fragment\n.highlight-red}\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n```{r}\ndf %>% kable(col.names = c(\"Strategy\",\"Cost\",\"QALYs\"),format.args = list(big.mark = \",\"),digits = 3) %>% \n  kable_styling()\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n[2. Sort table by costs in ascending order.]{.fragment\n.highlight-red}[^2]\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n[^2]: [Least costly first, most costly last]{.fragment .highlight-red}\n\n```{r}\ndf_s %>% kable(col.names = c(\"Strategy\",\"Cost\",\"QALYs\"),format.args = list(big.mark = \",\"),digits = c(1,0,3)) %>% \n  kable_styling()\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^3]\n\n[3. Calculate ICER based on difference in costs and effects.]{.fragment\n.highlight-red}\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n[^3]: Least costly first, most costly last\n\n```{r}\ndf_i2 %>% select(-status) %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\"),format.args = list(big.mark = \",\"), digits = c(1,0,0,3,3,0)) %>% \n  kable_styling() %>% \n  column_spec(c(3,5), background = \"yellow\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^4]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n[4. Determine dominated strategies (ICER\\<0)]{.fragment .highlight-red}\n:::\n:::\n\n[^4]: Least costly first, most costly last\n\n```{r}\n# color.me <- which(df_i2$status == \"Dominated\")\n# df_i2  %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\")) %>% \n#   kable_styling() %>%\n#   row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   Let's take a look at our table.\n-   Notice that strategy E has a **negative** ICER. Why is this?\n-   Strategy E raises costs but lowers QALYs.\n-   Therefore, we'd be better off by selecting strategy C (we would get\n    more health gain for less money...)\n:::\n\n```{r}\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% \n  mutate(status = \"\") %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"),\n        digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   **Strong dominance** refers to situations where one strategy is\n    preferred over another on both costs and health effects (e.g.,\n    QALYs).\n-   When we identify a strongly dominated option, we remove it from the\n    table and re-calculate ICERS based on the remaining strategies.\n:::\n\n```{r}\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"),digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## A Brief Aside on Negative ICERs\n\n-   We want to rule out strategies that cost *more* but result in less\n    health.\n    -   This implies a negative ICER.\n-   But what other scenario would result in a negative ICER?\n    -   Strategy adds health but reduces costs.\n    -   This is a great strategy!\n\n## Both Strategies Have a Negative ICER\n\n![](images/vis_icer-negative.png){fig-align=\"center\"}\n\n## A Brief Aside on Negative ICERs\n\n-   For this reason, it is poor practice to report negative ICERs.\n-   Be careful when deleting a strategy becuase it has a negative ICER!\n    -   It may be a great strategy!\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^5]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n[4. Determine dominated strategies (ICER\\<0)]{.fragment .highlight-red}\n:::\n:::\n\n[^5]: Least costly first, most costly last\n\n```{r}\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^6]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n4.  Determine dominated strategies (ICER\\<0).\n\n[5. Re-calculate ICERs after eliminating dominated\nstrategies.]{.fragment .highlight-red}\n:::\n:::\n\n[^6]: Least costly first, most costly last\n\n```{r}\n\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% mutate(d_cost = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_cost)) %>%\n  mutate(d_effect = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_effect))  %>%\n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>%\n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^7]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n4.  Determine dominated strategies (ICER\\<0).\n\n5.  Re-calculate ICERs after eliminating dominated strategies.\n:::\n:::\n\n[^7]: Least costly first, most costly last\n\n```{r}\ncolor.me <- grep(\"DominatedXXXXX\",df_i3$status)\ndf_i3  %>% \n  mutate(status = \"\") %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   We're not quite done yet\n-   Notice something odd about strategy B?\n-   Its ICER is **higher** than the next most costly alternative\n    (strategy D)\n:::\n\n```{r}\ncolor.me <- grep(\"B\",df_i3$strategy)\ndf_i3  %>% \n  mutate(status = \"\") %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#e5f536\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n-   A telltale sign of extended dominance in a (sorted) CEA table is a\n    strategy with a higher ICER than the next most expensive option.\n\n```{r}\ncolor.me <- grep(\"Dominated\",df_i3$status)\ndf_i3  %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: nonincremental\n-   You can see this in the pictures as well ....\n:::\n\n![](images/vis_icer11.png){fig-align=\"center\"}\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^8]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n4.  Determine dominated strategies (ICER\\<0).\n\n5.  Re-calculate ICERs after eliminating dominated strategies.\n\n[6. Determine strategies ruled out by extended dominance.]{.fragment\n.highlight-red}\n:::\n:::\n\n[^8]: Least costly first, most costly last\n\n```{r}\ncolor.me <- grep(\"Dominated\",df_i3$status)\ndf_i3  %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n[7. Re-calculate ICERs after ruling out all dominated\nstrategies.]{.fragment .highlight-red}\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n```{r}\ncolor.me <- grep(\"Dominated\",df_i4$status)\ndf_i4  %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n::: {style=\"font-size: 0.8em\"}\n-   Strategy D is more expensive than Strategy B, but Strategy D is\n    gaining health MORE EFFICIENTLY than Strategy B\n:::\n\n## In-class practice: DALYs {.smaller}\n\n**Nine** different prophylaxis to prevent someone with HIV from\nacquiring opportunistic infections related to AIDS\n\n::: {style=\"font-size: 0.8em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\ndf <- \n  tibble::tribble(\n                                          ~Strategy,      ~Cost, ~DALYs,\n                                   \"No prophylaxis\",  40288,  0,\n                                          \"TMP-SMX\",  44786,  2.56,\n                            \"TMP-SMX, azithromycin\",  45944,  3.04,\n                             \"TMP-SMX, fluconazole\",  47046,  3.01,\n               \"TMP-SMX, azithromycin, fluconazole\",  48596,   3.6,\n                             \"TMP-SMX, ganciclovir\",  54628,   3.2,\n               \"TMP-SMX, azithromycin, ganciclovir\",  56812,  3.83,\n                \"TMP-SMX, fluconazole, ganciclovir\",  58082,   3.8,\n  \"TMP-SMX, azithromycin, fluconazole, ganciclovir\",  61119,  4.62\n  ) %>% \n  mutate(DALYs = 9.5 - DALYs) %>% \n  mutate(iCost = c(0,diff(Cost))) %>% \n  mutate(DALYs_averted = -c(0,diff(DALYs))) %>% \n  select(Strategy, Cost, iCost,DALYs, everything())\n\ndf %>% \n  select(-DALYs_averted,-iCost) %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"DALYs\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling()\n```\n:::\n\n## Calculate Incremental Costs and DALYs Averted {.smaller}\n\n::: {style=\"font-size: 0.8em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"Incremental Cost\",\"DALYs\",\"DALYs Averted\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling() %>% \n  column_spec(c(3,5), background = \"yellow\")\n```\n:::\n\n## Calculate incremental costs per DALY averted. {.smaller}\n\n::: {style=\"font-size: 0.8em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf %>% \n  select(-Cost,-DALYs) %>% \n  mutate(iCost_per_DALY_averted = round(iCost/DALYs_averted,0)) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\"),\n        format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n    column_spec(c(4), background = \"yellow\")\n```\n:::\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf1 <- \n  df %>% \n  mutate(cost_per_daly_averted = iCost/DALYs_averted) %>% \n  mutate(status = ifelse(cost_per_daly_averted <0 , \"Dominated (Strong)\",\"\")) %>% \n  mutate(status = ifelse(is.na(status),\"\",status)) \n\ncolor.me.red <- which(df1$status == \"Dominated (Strong)\")\n\ndf1 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n    select(-Cost,-DALYs) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n:::\n\n# Remove dominated strategies and recalculate\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf2 <- \n  df1 %>% \n  group_by(status) %>% \n  nest()  %>% \n  filter(status==\"\") %>% \n  unnest(cols = c(data)) %>% \n  arrange(Cost) %>% \n  mutate(iCost = c(0,diff(Cost))) %>% \n  mutate(DALYs_averted = -c(0,diff(DALYs))) %>% \n  mutate(cost_per_daly_averted = iCost/DALYs_averted) %>% \n  mutate(status = ifelse(cost_per_daly_averted <0 , \"Dominated (Strong)\",\"\")) %>% \n  mutate(status = ifelse(cost_per_daly_averted > lead(cost_per_daly_averted), \"Dominated (Extended)\",status)) %>% \n  mutate(status = ifelse(is.na(status),\"\",status)) %>% \n  ungroup()\n\ndf2 %>% \n  select(Strategy,Cost,iCost,DALYs,DALYs_averted) %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"Incremental Cost\",\"DALYs\",\"DALYs Averted\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling()\n```\n:::\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\n\ncolor.me.red <- which(df2$status == \"Dominated (Strong)\" | df2$status == \"Dominated (Extended)\")\n\ndf2 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n  select(Strategy,iCost,DALYs_averted,cost_per_daly_averted,status) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n:::\n\n# Remove dominated strategies and recalculate\n\n## Determine dominated strategies {.smaller}\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf3 <- \n  df2 %>% \n  group_by(status) %>% \n  nest()  %>% \n  filter(status==\"\") %>% \n  unnest(cols = c(data)) %>% \n  arrange(Cost) %>% \n  mutate(iCost = c(0,diff(Cost))) %>% \n  mutate(DALYs_averted = -c(0,diff(DALYs))) %>% \n  mutate(cost_per_daly_averted = iCost/DALYs_averted) %>% \n  mutate(status = ifelse(cost_per_daly_averted <0 , \"Dominated (Strong)\",\"\")) %>% \n  mutate(status = ifelse(cost_per_daly_averted > lead(cost_per_daly_averted), \"Dominated (Extended)\",status)) %>% \n  mutate(status = ifelse(is.na(status),\"\",status)) %>% \n  ungroup()\n\ndf3 %>% \n  select(Strategy,Cost,iCost,DALYs,DALYs_averted) %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"Incremental Cost\",\"DALYs\",\"DALYs Averted\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling()\n```\n:::\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\n\ncolor.me.red <- which(df3$status == \"Dominated (Strong)\" | df3$status == \"Dominated (Extended)\")\n\ndf3 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n select(Strategy,iCost,DALYs_averted,cost_per_daly_averted,status) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n:::\n\n## Final Table {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\ndf4 <- \n  df3 %>%\n  bind_rows(df1 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%\n bind_rows(df2 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%  \n  mutate(cost_per_daly_averted = ifelse(status==\"\",cost_per_daly_averted,NA)) %>% \n  select(Strategy, iCost, DALYs_averted, cost_per_daly_averted, status)\n\ncolor.me.red <- which(df4$status == \"Dominated (Strong)\" | df4$status == \"Dominated (Extended)\")\n\ndf4 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") \n\n```\n:::\n\n## A note on COMPARATORS\n\n![](images/comparator1.png){width=\"564\"}\n\n::: notes\n-   \\*\\*The comparators are REALLY IMPORTANT\n-   Ideally, you want to identify ALL POSSIBLE interventions applicable\n    to the problem, including a \"do nothing\" option\n:::\n\n## A note on COMPARATORS\n\n![](images/comparator2.png){width=\"527\"}\n\n::: notes\n-   \\*\\*The results can be DECEPTIVE if you decide to omit any\n    comparators that are relevant to clinical practice\n\n-   FOR EXAMPLE, if you purposefully pick a \"no treatment\" comparator\n    but leave out a closer alternative, then the analysis will grossly\n    overstate the economic value of the drug you are assessing\n\n-   Same goes with an expensive & not very effective alternative & you\n    leave out options that are similar in effectiveness & cost\n:::\n\n# Where to draw the line? {background=\"#43464B\"}\n\n::: notes\n-   What CEA cannot tell us is HOW TO SPEND\n:::\n\n## CEA Thresholds\n\n::: incremental\n-   So now we have our ICERs, but how do we make a decision?\n-   We must define a **threshold** ($\\lambda$), or an ICER value that\n    determines whether or not we implement a given strategy.\n    -   Also known as \"willingness-to-pay\" (WTP) threshold.\n:::\n\n## CEA Thresholds\n\nWhat are common thresholds and how are they determined?\n\n::: incremental\n-   In high income countries, common thresholds are \\$50,000/QALY,\n    \\$100,000/QALY, and \\$100,000/QALY.\n-   In LMICs, 0.5-3x per capita gross domestic product (GDP) per DALY\n    averted.\n-   More on this in a few minutes.\n:::\n\n## How do CEA Thresholds Guide Decisionmaking?\n\n![](images/vis_wtp.png){fig-align=\"center\" width=\"469\"}\n\n## How do CEA Thresholds Guide Decisionmaking?\n\n![](images/vis_wtp2.png){fig-align=\"center\" width=\"469\"}\n\n## How do CEA Thresholds Guide Decisionmaking?\n\n![](images/thresholds1.png){fig-align=\"center\" width=\"469\"}\n\n::: notes\n(1) How do we know whether something is \"high-value\" versus \"low-value\"\n    or \"no-value\" healthcare?\n\n(2) Let's say we are comparing flu vaccination versus no vaccination &\n    that our cost-effectiveness ratio yields a price per unit benefit of\n    \\$90,000 / QALY gained\n\n(3) \\[ASK CLASS\\] - Would this be considered \"high-value\"?\n\n(4) This price must be compared to a benchmark or threshold representing\n    either what society is willing to pay for health gains or the\n    opportunity costs associated with displacing interventions within a\n    fixed budget\n\n(5) In the US, the benchmark is ROUGHLY around \\$100,000/QALY based on\n    willingness to pay estimates\n\n(6) A threshold's assumed value is really important because it\n    ultimately determines how society should invest in care, which\n    ultimately impacts overall population health.\n\n(7) Anything above this benchmark would be considered cost-Ineffective\n    (low value care)\n\n(8) Anything below would be considered high-value (gaining each\n    quality-adjusted life-year at a lower cost)\n\n(9) Anything to the left is NO value care\n\n(10) This is really important because... \\*\\*\\*Resources invested in low\n     or no-value interventions could be better applied to more effective\n     prevention and treatment strategies that will yield higher\n     population health outcomes.\n:::\n\n## CEA Thresholds {.smaller}\n\n![](images/vis_icer12.png){fig-align=\"center\"}\n\n## CEA Thresholds {.smaller}\n\n![](images/vis_icer13.png){fig-align=\"center\"}\n\n## CEA Thresholds {.smaller}\n\n![](images/vis_icer14.png){fig-align=\"center\"}\n\n## CEA Thresholds {.smaller}\n\n![](images/thokala.png)\n\nDifferent ways thresholds have been estimated: - \"supply-side\" (UK &\nEurope) - \"demand-side\" (US) - per capita consumption (US/LMICs)\n\n::: notes\n(1) There are different ways to determine a cost-effective threshold &\n    it's done a bit differently around the world, which we talk about in\n    a recent paper I collaborated with UK colleagues on, which discusses\n    the evolution of these thresholds.\n\n(2) Some countries like the UK, use what has been referred to as a\n    \"supply-side threshold\" -- which represents the notion of\n    opportunity cost -- whether the health generated from an adopted\n    intervention from NICE, for instance, is greater than the health\n    that could have been generated if the money had been spent on\n    something else - Under a fixed budget.\n\n(3) Another way that countries like the US have defined CE thresholds is\n    by what's called a \"demand-side\" perspective, or society's\n    \"willingness to pay\" for health gains. There's still an opportunity\n    cost associated with this but it's from the perspective of the goods\n    & services we would be willing to forego for these additional health\n    gains.\n\n(4) Similarly, another way that countries have looked at the threshold\n    is in terms of per capita consumption - consistent with the idea\n    that people living in countries with higher incomes are able and\n    willing to pay more for health - which makes intuitive sense\n:::\n\n## Opportunity cost (\"supply-side\") {.smaller}\n\n<br>\n\n::: incremental\n-   Decision should be informed by the value of what will be given up as\n    a consequence of those cost.\n\n    -   Known as the \"opportunity cost.\"\n\n-   If resources are committed to the funding of one intervention, then\n    they are not available to fund and deliver others **(shopping spree\n    concept)**\n\n-   The opportunity cost of a commitment of resources is the health\n    forgone because these \"other\" interventions that are available to\n    the health system cannot be delivered.\n\n-   Source: See K Claxton on the estimation of the NICE threshold in the\n    UK / Woods et al, & others\n:::\n\n## Opportunity cost (\"supply-side\") {.smaller}\n\n![](images/thresholds2.png)\n\n::: notes\n(1) This is the closest to a \"supply-side\" CEA estimate that the US has\n    approached\n(2) This simulation looked at the Opportunity Cost attributed to persons\n    dropping health insurance due to health insurance premium increases\n    (which often happens when intervention costs are very high -- it's\n    often the consumers that bear the burden)\n(3) The authors found that the threshold should be around \\$100,000/QALY\n    gained (which is typically what we use in the US)\n(4) But UK academics would argue that this isn't a true opportunity cost\n    estimate because it doesn't evaluate the opportunity cost of\n    displacing interventions for other more effective (but often more\n    costly) alternatives --\n\n-   either within the health care sector or displacing other programs in\n    other sectors because of how much we spend on health care\n-   & there's many other things to consider such as effect of increasing\n    healthcare costs on patient copays, wait times, generosity of\n    employer plans, or on public insurance\n:::\n\n## Opportunity cost (\"supply-side\") {.smaller}\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n> If you don't consider the budget under which you are operating, then\n> some medications could take up half the budget and displace\n> interventions that produce significant health gain OR in the US, could\n> increase premiums or take away \\$\\$ from other sectors\n\n> Academics have argued that the threshold should be lower/on the more\n> conservative end for higher priced therapies (NICE uses a budget\n> impact threshold of 20,000 GBP/QALY for these higher priced therapies\n> as opposed to 30,000 GBP/QALY for others)\n:::\n\n## Willingness to pay (\"demand-side\")\n\n![](images/thresholds3.png)\n\n::: notes\n(1) Given that our health system is more complicated & we don't\n    necessarily have a \"fixed\" budget, per se, the US has largely\n    defined thresholds based on what is often referred to as\n    \"demand-side\" or \"willingness-to-pay\" criteria, which can also be\n    represented as the willingness to forego other types of consumption\n    to improve one's health.\n\n(2) This willingness to pay has been derived through surveys & also what\n    Medicare has been willing to pay for interventions\n\n(3) Some have argued that understanding a population's willingness to\n    pay is important, especially in a single-payer system that is funded\n    through social insurance -- ensuring that individuals have a role in\n    decision-making\n\n(4) But there is huge variation in willingness to pay studies - varied\n    substantially by condition, especially those for extending or saving\n    life (higher WTP).\n\n(5) This very short perspective piece gives an overview of the\n    thresholds we have used in the US in the past & what they are\n    largely based on (has largely been arbitrary) -- it's 2 pages &\n    would recommend reading\n:::\n\n## CEA Thresholds in LMICs\n\n![](images/thresholds4.png)\n\n::: notes\n(1) Other thresholds that countries have used are based on per capita\n    GDP; mainly the threshold of 1-3X per capita GDP\n\n(2) Although this threshold range roughly corresponds to what has become\n    convention for high-income countries (1X per capita GDP in the US is\n    around \\$60,000 & 3 times that is the upper end of what we use --\n    typically use 50,000 as lower end, 100,000 as the base, and 150,000\n    as an upper end)\n\n(3) BUT per capita consumption in wealthier countries exceeds the per\n    capita consumption in low & middle-income countries by one-to-two\n    orders of magnitude & therefore, some analysts have argued that\n    healthcare spending should represent a smaller portion of per capita\n    GDP in low to middle income countries.\n:::\n\n## CEA Thresholds in LMICs {.smaller}\n\n<br>\n\n::: incremental\n-   Past WHO guidelines recommended countries use following guidelines:\n    An intervention is cost-effective if cost/DALY averted is less than\n    1-3X per capita GDP of country\n-   Some have argued the WHO's guidelines may be too high and result in\n    adoption of interventions that displace existing services that\n    provide greater health benefit.\n-   Suggest 0.5 GDPpc is a more appropriate benchmark for low-income\n    countries and 0.71 GDPpc for middle-income countries (see Woods et\n    al 2016)\n:::\n\n::: notes\n(1) Analysts have also argued that the threshold should be lower for\n    these countries based on a healthcare budget perspective\n\n(2) In Peru, for example, a study found that the addition of one breast\n    cancer treatment could be cost-effective under the broad 1-3X per\n    capita GDP criteria; however, the cost of adding the new drug would\n    exceed Peru's entire budget for breast cancer treatment.\n:::\n\n## CEA Thresholds in LMICs\n\n![](images/thresholds5.png)\n\n::: notes\n(1) You can see from my paper on this --\n\n(2) We found:\n\n-   The proportion of PUBLISHED studies citing a threshold of 1-3X per\n    capita GDP has increased over time & this largely corresponds to the\n    WHO recognition of this threshold in the early 2000s -- prior to\n    this, most studies either cited no threshold or other CE thresholds\n\n-   The WHO has since moved away from recommended this threshold since\n    it has received A LOT of backlash, including from my paper\n\n(3) Until we come up with a better measure, the DSP3 & other academics\n    have estimated more conservative thresholds (previous slide) that I\n    would use for LMICs & would NOT use the per capita assumptions\n\n(4) But we still don't have a perfect threshold estimate\n:::\n\n## HIV Example From Earlier {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\ndf4 <- \n  df3 %>%\n  bind_rows(df1 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%\n bind_rows(df2 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%  \n  mutate(cost_per_daly_averted = ifelse(status==\"\",cost_per_daly_averted,NA)) %>% \n  select(Strategy, iCost, DALYs_averted, cost_per_daly_averted, status)\n\ncolor.me.red <- which(df4$status == \"Dominated (Strong)\" | df4$status == \"Dominated (Extended)\")\n\ndf4 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") \n\n```\n:::\n\n## HIV Example from Earlier {.smaller}\n\n<br>\n\n-   If our CE threshold was 2x GDP (GDP = \\$2,500), which option would\n    we choose as decision makers?\n-   If our CE threshold was 1x GDP (GDP = \\$2,500), which option would\n    we choose as decision makers?\n\n# Next: ICER Case Study {background=\"#43464B\"}\n","srcMarkdownNoYaml":"\n\n```{r, echo = FALSE}\nlibrary(tidyverse)\nlibrary(DiagrammeR)\nlibrary(here)\nlibrary(glue)\nlibrary(Matrix)\nlibrary(expm)\nlibrary(ggrepel)    # For plotting\nlibrary(ellipse)    # For plotting\nlibrary(scales)     # For dollar signs and commas\nlibrary(randtoolbox)\nlibrary(igraph)\nlibrary(tidygraph)\nlibrary(ggraph)\nlibrary(progress)\nlibrary(hrbrthemes)\nlibrary(ggsci)\nlibrary(directlabels)\nlibrary(gt)\nlibrary(ggpmisc)\nlibrary(kableExtra)\nlibrary(knitr)\noptions(knitr.kable.NA = '') \n```\n\n```{=html}\n<style>\n.nobullet li {\n  list-style-type: none;\n}\n</style>\n```\n\n```{r, echo = FALSE}\n\nsource(\"./functions_healthy-sick-dead.r\")\n\ntheme_cea<- function(base_size = 11, base_family = \"Gill Sans\", ticks = TRUE) {\n  \n  ret <- ggplot2::theme_bw(base_family = base_family, base_size = base_size) +\n    ggplot2::theme(\n      axis.line = ggplot2::element_blank(),\n      axis.title.x = ggplot2::element_text(vjust = -0.3),\n      axis.title.y = ggplot2::element_text(vjust = 0.8),\n      legend.background = ggplot2::element_blank(),\n      legend.key = ggplot2::element_blank(),\n      legend.title = ggplot2::element_text(face=\"plain\"),\n      panel.background = ggplot2::element_blank(),\n      panel.border = ggplot2::element_blank(),\n      panel.grid = ggplot2::element_blank(),\n      plot.background = ggplot2::element_blank(),\n      strip.background = ggplot2::element_blank()\n    )\n  \n  if (!ticks) {\n    ret <- ret + ggplot2::theme(axis.ticks = ggplot2::element_blank())\n  }\n  \n  ret\n}\n\nload(\"./data/df_cea.RData\")\n\ndf <- \n  df_cea %>% \n  select(Cost, Effect) %>% \n  rownames_to_column(var= \"strategy\") %>% \n  select(strategy, everything()) \n\ndf_s <- \n  df_cea %>% \n  arrange(Cost) %>% \n  select(Cost, Effect) %>% \n  rownames_to_column(var= \"strategy\") %>% \n  select(strategy, everything())\n\ndf_i1 <-\n  df_cea %>%\n  rownames_to_column(var= \"strategy\") %>% \n  select(strategy, everything()) %>% \n  arrange(Cost) %>%\n  mutate(d_cost = round(Cost - lag(Cost),0),\n         d_effect = round(Effect - lag(Effect),3)) %>%\n  select(strategy, Cost, d_cost ,Effect, d_effect)\n\ndf_i2 <- \n  df_i1 %>% \n  mutate(icer = d_cost / d_effect) %>% \n  mutate(status = case_when(icer<0 ~ \"Dominated\",\n                            TRUE ~ \"\" )) \n\ndf_i3 <- \n  df_i2 %>% \n  #filter(status != \"Dominated\") %>% \n  arrange(status,Cost) %>%\n mutate(d_cost = round(Cost - lag(Cost),0),\n         d_effect = round(Effect - lag(Effect),3)) %>%\n  mutate(icer = d_cost / d_effect) %>% \n  mutate(icer = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, icer)) %>% \n  mutate(d_cost = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_cost)) %>% \n  mutate(d_effect = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_effect)) %>% \n  mutate(status = case_when(!is.na(icer) & icer<0 ~ \"Dominated\",\n                             !is.na(icer) & icer > lead(icer) & lead(status) != \"Dominated\" ~ \"Dominated (Extended)\",\n                             TRUE ~ status))\n\ndf_i4 <- \n  df_i3 %>% \n  arrange(status, Cost) %>% \n  mutate(d_cost = round(Cost - lag(Cost),0),\n         d_effect = round(Effect - lag(Effect),3)) %>%\n  mutate(icer = d_cost / d_effect) %>% \n  mutate(icer = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, icer)) %>% \n  mutate(d_cost = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_cost)) %>% \n  mutate(d_effect = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_effect)) %>% \n  \n  mutate(status = case_when(!is.na(icer) & icer<0 ~ \"Dominated\",\n                             !is.na(icer) & icer > lead(icer) & lead(status) != \"Dominated\" ~ \"Dominated (Extended)\",\n                             TRUE ~ status))\n                            \n\n```\n\n# Learning Objectives and Outline\n\n## Learning Objectives\n\n-   Differentiate between average & incremental CEA ratios\n\n-   Characterize decision problems by whether they are competing or\n    non-competing\n\n-   Compute and interpret ICERs\n\n-   Practice ruling out \"dominated\" and \"extendedly dominated\"\n    strategies\n\n-   Identify \"high-value\" versus \"low value\" care strategies, based on\n    generally accepted cost-effectiveness thresholds\n\n## Outline\n\n<br>\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Review of CEA ratio\n2.  Non-competing versus competing CEAs\n3.  Incremental CEA\n:::\n\n::: {.column width=\"50%\"}\n4.  Dominance & extended dominance\n5.  Comparators\n6.  CEA thresholds\n:::\n:::\n\n# Cost-Effectiveness Analysis {background=\"#43464B\"}\n\n## Cost-Effectiveness Analysis\n\n::: incremental\n-   Quantifies how to maximize the quality & quantity of life from among\n    competing alternatives, given restricted resources\n\n-   It's an explicit measure of value for money\n\n-   A POPULATION-LEVEL decision-making tool\n:::\n\n## Cost-Effectiveness Analysis IS NOT\n\n::: incremental\n-   Indiscriminate cost-cutting\n-   Downsizing\n-   For individual-level decision making\n-   The only tool for decision-making\n:::\n\n## Cost-Effectiveness Analysis {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: {data-id=\"costA\"}\nCost of Intervention\n:::\n\n::: {data-id=\"costB\"}\nCost of Alternative\n:::\n\n::: {data-id=\"benefitA\"}\nBenefit of Intervention\n:::\n\n::: {data-id=\"benefitB\"}\nBenefit of Alternative\n:::\n:::\n\n## Cost-Effectiveness Analysis {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\nCost of Intervention\n:::\n\n::: {data-id=\"costB\" style=\"color: #B98476;\"}\nCost of Alternative\n:::\n\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\nBenefit of Intervention\n:::\n\n::: {data-id=\"benefitB\" style=\"color: #3FA090;\"}\nBenefit of Alternative\n:::\n:::\n\n## Cost-Effectiveness Ratio {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: r-hstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\nCost of Intervention\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"costB\" style=\"color: #B98476;\"}\nCost of Alternative\n:::\n:::\n\n$$\\frac{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}$$\n\n::: r-hstack\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\nBenefit of Intervention\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"benefitB\" style=\"color: #3FA090;\"}\nBenefit of Alternative\n:::\n:::\n:::\n\n## Cost-Effectiveness Ratio {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: r-hstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\n$C_1$\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"costB\" style=\"color: #B98476;\"}\n$C_0$\n:::\n:::\n\n$$\\frac{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}{\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad}$$\n\n::: r-hstack\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\n$E_0$\n:::\n\n$$ \\quad - \\quad $$\n\n::: {data-id=\"benefitB\" style=\"color: #3FA090;\"}\n$E_1$\n:::\n:::\n:::\n\n## Cost-Effectiveness Ratio {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: r-vstack\n::: r-hstack\n::: {data-id=\"costA\" style=\"color: #B98476;\"}\n$\\Delta C$\n:::\n:::\n\n$$\\frac{\\quad \\quad \\quad \\quad }{\\quad \\quad \\quad \\quad \\quad }$$\n\n::: r-hstack\n::: {data-id=\"benefitA\" style=\"color: #3FA090;\"}\n$\\Delta E$\n:::\n:::\n:::\n\n## Incremental Cost-Effectiveness Ratio {.smaller}\n\n**Most often used, since for most conditions there is already some\navailable treatment.**\n\n::: incremental\n::: columns\n::: {.column width=\"50%\"}\n-   $C_1$: net present value of total lifetime costs of new treatment\n-   $C_0$: net present value of total lifetime costs of default\n    treatment\n-   $E_1$: effectiveness of new treatment, measured in expected life\n    expectancy, quality-adjusted life years (QALYs) or\n    disability-adjusted life years (DALYs), or some decision-relevant\n    health outcome.\n-   $E_0$: effectiveness of default treatment\n:::\n\n::: {.column width=\"50%\"}\n::: {style=\"padding-top: 100px;\"}\n$$\n\\frac{C_1 - C_0 \\quad  (\\Delta C)}{E_1 - E_0 \\quad  (\\Delta E)}\n$$\n:::\n:::\n:::\n:::\n\n<!-- # Example: Neurologic Disease -->\n\n<!-- ## Neurologic Disease Decision Tree -->\n\n<!-- - Consider a neurologic disease that blocks a certain cell receptor in the brain.  -->\n\n<!-- - If left untreated, the disease is lethal for 50 out of every 1,000 people. -->\n\n<!-- ## Neurologic Disease Decision Tree -->\n\n<!-- - A hypothetical new treatment reduces the mortality rate to to 15 out of every 1,000, but only among people with the certain cell receptor.  -->\n\n<!-- - Among people without the receptor, the treatment confers a 1% probability of death.  -->\n\n<!-- ## Neurologic Disease Decision Tree -->\n\n<!-- - Rather than treat none or treat all suspected with the disease, a biopsy option is available. -->\n\n<!-- - TK -->\n\n\n## Neurologic Disease Decision Tree\n\n\n![](images/cea-example1.png)\n\n## Outcomes\n\n-   $C_{treat}$ = expected cost of treat everyone strategy.\n-   $C_{no treat}$ = expected cost of treat *no one* strategy.\n-   $C_{biopsy}$ = expected cost of biopsy strategy.\n\n## Outcomes\n\n-   $C_{treat}$ = expected cost of treat everyone strategy.\n-   $C_{no treat}$ = expected cost of treat *no one* strategy.\n-   $C_{biopsy}$ = expected cost of biopsy strategy.\n-   $E_{treat}$ = expected life expectancy of treat everyone strategy.\n-   $E_{no treat}$ = expected expectancy of treat *no one* strategy.\n-   $E_{biopsy}$ = expected expectancy of biopsy strategy.\n\n## Outcomes in Amua\n\n![](images/outcomes-amua.png){fig-align=\"center\"}\n\n## Treat All vs. Treat None\n\nStrategy: Treat No One ![](images/cea-example2.png)\n\n## Treat All vs. Treat None\n\nStrategy: Treat All ![](images/cea-example3.png)\n\n## Key Takeaways (For Now)\n\n::: incremental\n-   Treatment yields *higher* life expectancy for those with disease,\n    but comes at a cost.\n-   Treatment yields *lower* life expectancy for those without the\n    disease, *and also* comes at a cost.\n-   Biopsy can help balance these two outcomes by better targeting\n    treatment, but also comes with costs and risks.\n-   Incremental CEA provides a transparent framework for quantifying and\n    weighing these considerations.\n:::\n\n## Average Cost-Effectiveness Ratio {.smaller}\n\n**Special case where** $C_0$ and $E_0$ are assumed to be zero.\n\n::: columns\n::: {.column width=\"50%\"}\n-   $C_1$: net present value of total lifetime costs of new treatment\n-   $C_0$: Assumed zero\n-   $E_1$: effectiveness of new treatment, measured in expected life\n    expectancy, quality-adjusted life years (QALYs) or\n    disability-adjusted life years (DALYs), or some decision-relevant\n    health outcome.\n-   $E_0$: Assumed zero\n:::\n\n::: {.column width=\"50%\"}\n::: {style=\"padding-top: 50px;\"}\n$$\n\\begin{aligned}\nICER &=  \\frac{C_1 - 0}{E_1 - 0} \\\\\n &= \\frac{C_1}{E_1 }\n\\end{aligned}\n$$\n:::\n:::\n:::\n\n# Non-Competing vs. Competing CEAs {background=\"#43464B\"}\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n1.  **Shopping Spree**: Decision problem has non-competing\n    programs/interventions.\n\n-   Each program is compared to a null alternative; therefore, you're\n    calculating an \"average\" cost-effectiveness ratio.\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n2.  **Competing Choice**: Decision problem has competing\n    programs/interventions for the same purpose; these choices are\n    mutually exclusive.\n\n-   Two or more active alternatives in addition to the null option.\n-   You need to calculate an \"incremental cost- effectiveness ratio\",\n    which gives us the added cost per unit of added benefit of an\n    option, relative to the next less expensive choice\n\n## Non-Competing (Shopping Spree) Decision Problem\n\n**How can we measure the relative priority of various health programs\nthat compete for limited resources?**\n\n::: incremental\n1.  Cardiovascular disease program\n2.  Safe motherhood program\n3.  HIV prevention initiative\n4.  Child vaccination\n5.  Depression screening\n:::\n\n## Assumptions\n\n::: incremental\n-   Program alternatives are assumed to be independent\n-   Budget constraint is only limitation\n-   Neither the net cost nor the net effectiveness depend on what other\n    programs are selected\n-   Programs are assumed to be divisible \\[programs can be partially\n    implemented\\]\\\n:::\n\n## Objectives: Shopping Spree Problem {background=\"#c2f0c2\"}\n\n#### {{< fa circle-check >}} Maximize the total net effectiveness (health benefit) of the programs selected.\n\n#### {{< fa circle-check >}} Stay within budget.\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\nStep 1: - Rule out programs that cost \\$ but have negative health\neffects <br> - Dominated by alternative of \"no program\"\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n#| fig-width: 8\n#| fig-align: center\n\ndf_ex <- \n  tibble(\n  program = LETTERS[1:8],\n  cost = c(27,30,56,20,30,50,40,-20),\n  qalys = c(30,20,70,40,50,75,-30,20)\n  ) %>% \n  mutate(type = case_when(cost > 0 & qalys <0 ~ \"cp_en\",\n                          cost <0  & qalys > 0 ~ \"cn_ep\",\n                          cost >0 & qalys > 0 ~ \"cp_ep\")) %>% \n  mutate(label = case_when(type == \"cp_en\" ~ \"Less effective\\nmore costly\",\n                           type == \"cn_ep\" ~ \"More effective\\nless costly\",\n                           type == \"cp_ep\" ~ \"More effective\\nmore costly\"))\n\n  df_ex %>% \n    filter(type %in% c(\"cp_en\")) %>% \n    ggplot(aes(x = qalys, y = cost)) + \n    theme_cea() + \n    geom_point(size=6, aes(pch=type,colour = type)) +\n    geom_quadrant_lines(linetype = \"solid\") +\n    #hrbrthemes::theme_ipsum(base_size=16) + \n    theme(axis.title.x = ggplot2::element_text( size=24, angle=0),\n          axis.title.y = ggplot2::element_text(size = 24,angle=1)) + \n    scale_x_continuous(limits = c(-max(abs(df_ex$qalys)),max(abs(df_ex$qalys))), breaks = NULL , position=\"top\") + \n    scale_y_continuous(limits = c(-max(abs(df_ex$cost)),max(abs(df_ex$cost))), breaks = NULL ,position = \"right\") +\n    labs(x = \"Incremental Costs\", y = \"Incremental Health\") + \n    geom_dl(method = list(\"smart.grid\",hjust=.9,cex=2,vjust=1),aes(label = glue(\"{label}\"))) +\n    theme(legend.position =\"none\") +\n    scale_shape_manual(values = c(4)) + \n    scale_colour_manual(values = c(\"red\")) + \n    geom_label(aes(label=program),size=10)\n\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\nStep 2:\\\n- Select programs that are cost-saving & offer benefit; net savings can\nalso be added to budget <br> - Cost-saving compared to alternative of no\nprogram\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n#| fig-width: 8\n#| fig-align: center\n\n  df_ex %>% \n  filter(type %in% c(\"cp_en\",\"cn_ep\")) %>% \n  ggplot(aes(x = qalys, y = cost)) + \n  theme_cea() + \n  geom_point(size=6, aes(pch=type,colour = type)) +\n  geom_quadrant_lines(linetype = \"solid\") +\n  #hrbrthemes::theme_ipsum(base_size=16) + \n  theme(axis.title.x = ggplot2::element_text( size=24, angle=0),\n        axis.title.y = ggplot2::element_text(size = 24,angle=1)) + \n  scale_x_continuous(limits = c(-max(abs(df_ex$qalys)),max(abs(df_ex$qalys))), breaks = NULL , position=\"top\") + \n  scale_y_continuous(limits = c(-max(abs(df_ex$cost)),max(abs(df_ex$cost))), breaks = NULL ,position = \"right\") +\n  labs(x = \"Incremental Costs\", y = \"Incremental Health\") + \n  geom_dl(method = list(\"smart.grid\",hjust=.9,cex=2,vjust=1),aes(label = glue(\"{label}\"))) +\n  theme(legend.position =\"none\") +\n  scale_shape_manual(values = c(19,4,3)) + \n  scale_colour_manual(values = c(\"darkgreen\",\"red\",\"blue\")) + \n  geom_label(aes(label=program),size = 10)\n\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\nStep 3:\\\n- Rank other programs in ascending order by their cost-effectiveness\nratio (lowest to highest) <br> - Programs are then selected from the\nLEAST to the MOST expensive until the budget is expended <br> - Final\narray of programs selected will depend on the budget constraint\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n#| fig-width: 5\n#| fig-align: center\n\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\"))) %>% \n  ggplot(aes(x = qalys, y = cost)) + \n\n  #geom_point(size=6, aes(pch=type,colour = type)) +\n  geom_quadrant_lines(linetype = \"solid\") +\n  #hrbrthemes::theme_ipsum(base_size=16) + \n    geom_label(aes(label=program), colour = \"black\") + \n  theme(axis.title.x = ggplot2::element_text( size=24, angle=0),\n        axis.title.y = ggplot2::element_text(size = 24,angle=1)) + \n  scale_x_continuous(limits = c(-max(abs(df_ex$qalys)),max(abs(df_ex$qalys))), breaks = NULL , position=\"top\") + \n  scale_y_continuous(limits = c(-max(abs(df_ex$cost)),max(abs(df_ex$cost))), breaks = NULL ,position = \"right\") +\n  labs(x = \"Incremental Costs\", y = \"Incremental Health\") + \n  #geom_dl(method = list(\"first.points\",hjust=2,cex=2),aes(label = glue(\"{program}\"))) +\n  theme(legend.position =\"none\") +\n  scale_shape_manual(values = c(3))  + \n  theme_cea() \n  #scale_colour_manual(values = c(\"blue\")) \n\n\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\nSteps 1 & 2: Rule out dominated options & select cost-saving\ninterventions <br>\n\n```{r}\ncolor.me.red <- which(df_ex$type == \"cp_en\")\ncolor.me.green <- which(df_ex$type == \"cn_ep\")\n\ndf_ex %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,status) %>% kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"Status\"),format.args = list(big.mark = \",\")) %>% \n    kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\ndf_ex_excl <- \n  df_ex %>%\n  mutate(status = case_when(type==\"cp_en\" ~ \"Higher Costs, Worse Health\",\n                            type==\"cn_ep\" ~ \"Lower Costs, Better Health\")) %>% \n         \n         select(program,cost,qalys,status) %>% \n  na.omit()\n```\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\n-   Initial budget: \\$80\n-   Budget savings: [\\$20]{style=\"color: #a8d4a7;\"}.\n-   Total budget: \\$80 + [\\$20]{style=\"color: #a8d4a7;\"} = \\$100\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n\ncolor.me.red <- which(df_ex$type == \"cp_en\")\ncolor.me.green <- which(df_ex$type == \"cn_ep\")\n\ndf_ex %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,status) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"Status\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\n-   Calculate average cost-effectiveness ratio.\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2))\n\ncolor.me.red <- which(df_ex_$type == \"cp_en\")\ncolor.me.green <- which(df_ex_$type == \"cn_ep\")\n\ndf_ex_ %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,ce) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n:::\n:::\n\n## Shopping Spree Problem {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n-   Calculate average cost-effectiveness ratio.\n-   Sort (by C/E) in ascending order .\n:::\n\n::: {.column width=\"50%\"}\n```{r}\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2)) %>% \n  arrange(ce)\n\ncolor.me.red <- which(df_ex_$type == \"cp_en\")\ncolor.me.green <- which(df_ex_$type == \"cn_ep\")\n\ndf_ex_ %>% \n  mutate(status = case_when(type==\"cp_en\" ~ \"Ruled Out\",\n                            type==\"cn_ep\" ~ \"Adopted\")) %>% \n         \n         select(program,cost,qalys,ce) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n:::\n:::\n\n::: notes\n-   We want to order the RATIOS from lowest to highest for budget\n    inclusion SINCE lower means we are gaining QALYs more efficiently --\n    or gaining more benefit per dollar spent on care \\*\\*\\*\\*\\*\n:::\n\n## Shopping Spree Problem\n\n::: incremental\n-   Calculate cumulative costs\n-   Determine what is adoptable based on global budget constraint\n    (\\$100)\n-   Calculate cumulative effects (QALYs)\n:::\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$100\n\n```{r}\n\nbudget <- 100\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2)) %>% \n  arrange(ce) %>% \n  mutate(cumcost = cumsum(cost)) %>%\n  mutate(cumeffect=cumsum(qalys)) %>% \n  mutate(in_budget = as.integer(cumcost<=budget))\n\ncolor.me.red <- which(df_ex_$in_budget==0)\ncolor.me.green <- which(df_ex_$in_budget == 1)\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"Out of Budget\",\n                            in_budget==1 ~ \"Within Budget\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) #%>% \n  # kableExtra::kable_styling() %>%\n  # kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  # kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$100\n\n```{r}\n\ncolor.me.red <- which(df_ex_$in_budget==0)\ncolor.me.green <- which(df_ex_$in_budget == 1)\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n\n```{r}\ndf_ex_[color.me.green,] %>% \n  bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  mutate(Budget = budget) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n::: notes\n(1) If we have a budget of \\$100, then based on our program options, we\n    could fund program D, E, & F -- with a cumulative cost of \\$100\n\n(2) Total health benefit would include on average, 165 quality-adjusted\n    life years gained from these programs together\n\n(3) & we might then say that our cost effectiveness threshold would be\n    at \\$0.667 per QALY gained -- \\*\\* this represents the point at\n    which the budget is \"optimally\" allocated given budget constraints\n\n(4) More on thresholds later\n:::\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$150\n\n```{r}\n\nbudget = 150\n\ndf_ex_ <-\n  df_ex %>% \n  filter(!(type %in% c(\"cp_en\",\"cn_ep\")))  %>% \n  mutate(ce = round(cost/qalys,2)) %>% \n  arrange(ce) %>% \n  mutate(cumcost = cumsum(cost)) %>%\n  mutate(cumeffect=cumsum(qalys)) %>% \n  mutate(in_budget = as.integer(cumcost<=budget))\n\n\ncolor.me.red <- which(df_ex_$in_budget==0)\ncolor.me.green <- which(df_ex_$in_budget == 1)\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\")\n\n```\n\n```{r}\ndf_ex_[color.me.green,] %>% \n    bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost,na.rm=TRUE), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  mutate(Budget = budget) %>% \n  mutate(Remaining = budget - Cost) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$150\n\n```{r}\ncolor.me.red <- which(df_ex_$in_budget==0)[-1]\ncolor.me.green <- which(df_ex_$in_budget == 1)\ncolor.me.yellow <- which(df_ex_$in_budget==0)[1]\n\ndf_ex_ %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\") %>% \n  kableExtra::row_spec(color.me.yellow, bold = T, color = \"black\", background = \"#e3df74\")\n\n```\n\n```{r}\ndf_ex_[color.me.green,] %>% \n    bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost,na.rm=TRUE), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  mutate(Budget = budget) %>% \n  mutate(Remaining = budget - Cost) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n## Shopping Spree Problem {.smaller}\n\nBudget: \\$150\n\n```{r}\ndf_ex_ %>% \n  mutate(diff = pmax(0,cumcost-budget)) %>% \n  mutate(test = (cost-diff)/cost) %>% \n  mutate(program = ifelse(diff==0 ,program,\n                          ifelse((cost-diff)/cost>0,\n                                 paste0(program,\" (\",round(100*(cost-diff)/cost,1),\"%)\"),program))) %>% \n  mutate(status = case_when(in_budget==0 ~ \"\",\n                            in_budget==1 ~ \"\")) %>% \n         \n         select(program,cost,qalys,ce,cumcost,cumeffect) %>% \n  kable(col.names = c(\"Program\",\"Cost\",\"QALYs\",\"C/E\",\"Cumulative Cost\",\"Cumulative QALYs\"),format.args = list(big.mark = \",\")) %>% \n  kableExtra::kable_styling() %>%\n  kableExtra::row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") %>% \n  kableExtra::row_spec(color.me.green, bold = T, color = \"black\", background = \"#a8d4a7\") %>% \n  kableExtra::row_spec(color.me.yellow, bold = T, color = \"black\", background = \"#e3df74\")\n\n```\n\n```{r}\ndf_ex_[c(color.me.green,color.me.yellow),]  %>% \n  mutate(diff = pmax(0,cumcost-budget)) %>% \n  mutate(program = ifelse(diff==0,program,paste0(program,\" (\",round(100*(cost-diff)/cost,1),\"%)\"))) %>% \n  mutate(cost = cost *(cost-diff)/cost) %>% \n  mutate(qalys = qalys * (cost-diff)/cost) %>% \n  mutate(cumcost = cumsum(cost),cumeffect=cumsum(qalys)) %>% \n  bind_rows(df_ex_excl %>% filter(qalys>0) %>% mutate(cost=NA,qalys=NA)) %>% \n  summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost,na.rm=TRUE), Effect = sum(qalys,na.rm=TRUE), Threshold = max(ce,na.rm=TRUE)) %>% \n  \n  #summarise(Adopted=paste0(program,collapse=\", \"), Cost = sum(cost), Effect = sum(qalys), Threshold = max(ce)) %>% \n  mutate(Budget = budget) %>% \n  mutate(Remaining = budget - Cost) %>% \n  select(Budget,everything()) %>% \n  kable() %>% \n    kableExtra::kable_styling()\n```\n\n::: {style=\"font-size: 0.8em\"}\n-   \\$50 left but program C costs \\$56 (50/56 = 0.89)\n-   0.89\\*70 QALYs of program C = 62.3 QALYs\n:::\n\n## Summary: Shopping Spree Problem\n\n#### {{< fa circle-check >}} Maximize the total net effectiveness (health benefit)\n\n#### {{< fa circle-check >}} Stay within budget\n\n#### {{< fa note-sticky >}} Can do the same with other objectives (e.g., Minimize costs, subject decision to 'minimum benefit' constraint, etc.)\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n::: {.fragment .highlight-grey}\n1.  **Shopping Spree**: Decision problem has non-competing\n    programs/interventions.\n:::\n\n## Use of CEA in two situations {auto-animate=\"true\"}\n\n2.  **Competing Choice**: Decision problem has competing\n    programs/interventions for the same purpose; these choices are\n    mutually exclusive.\n\n## Objectives: Competing Choice Problem {background=\"#c2f0c2\"}\n\n#### {{< fa circle-check >}} Cannot implement more than one strategy at a time.\n\n#### {{< fa circle-check >}} Incremental cost-effectiveness ratio is below a pre-specified adoption threshold.\n\n## What's different?\n\n::: columns\n::: {.column width=\"50%\"}\n**Shopping Spree**\n\n1.  Can select multiple programs\n2.  Different costs & effects associated with each\n3.  Requires calculation of an *Average Cost-Effectiveness Ratio*\n:::\n\n::: {.column width=\"50%\"}\n**Competing Choice**\n\n1.  [Programs are mutually exclusive.]{style=\"color: red;\"}\n2.  Different costs & effects associated with each.\n3.  [Requires calculation of an *Incremental Cost-Effectiveness Ratio*\n    (ICER)]{style=\"color: red;\"}\n:::\n:::\n\n::: notes\n\\(1\\) Opioid pharmacotherapy is the recommended treatment for OUD in\npregnancy, as we know that medication reduces the risk of overdose and\nrelapse, improves overall retention to care, and improves pregnancy &\nfetal outcomes.\n\n(2) There are three classes of medications approved by the FDA -- &\n    there are several sub-modalities that are not listed here that we\n    are modeling -- such as injectable formulations versus monotherapy /\n    etc.\n\n(3) But overall -- there are options like Methadone that are full\n    \"agonists\" -- where the effects of the treatment increase as the\n    dose increases\n\n(4) Buprenorphine which is a partial agonist -- in other words,\n    buprenorphine has a \"ceiling effect\", so its effects can only be\n    felt up to a certain point & then plateaus thereafter\n\n(5) And Naltrexone, which is an \"antagonist\" and works by blocking\n    opioid receptors & reduces & suppresses opioid cravings\n\n(6) The difficult tradeoffs of these therapies, include:\n\n-   Access challenges & delays in care -- for instance, there's a\n    limited \\# of methadone clinics across the US -- there are only 3\n    methadone clinics in Nashville (22 total in the state) & 5 total in\n    neighboring Mississippi\n\n-   & while buprenorphine & naltrexone, for example, can be administered\n    in any office-based setting, methadone can only be dispensed in\n    these specialty OTP clinics that I had mentioned earlier\n\n-   For opioid recurrence or disengagement from treatment rates,\n    Methadone may have better outcomes BUT methadone also poses a\n    significant risk of mortality from opioid overdose due to\n    respiratory depression during treatment induction\n\n-   Regarding infant outcomes, buprenorphine has performed better than\n    methadone when it comes to outcomes like preterm birth, neonatal\n    withdrawal syndrome, & length of hospital stay, but infants exposed\n    to Naltrexone have the least severe withdrawal overall & lowest\n    hospital length of stay\n\n-   There are also different tradeoffs associated with treatment\n    modalities such as tablets, film, injectables\n\n-   And then there's many other things to consider such as inpatient\n    versus outpatient induction periods versus continuation of care AND\n    outcomes associated with injection versus non-injection users\n\n(7) While individuals can switch back & forth between these medications,\n    they can only be on ONE medication at a time & we have to decide\n    what is the best option for pregnant invidivudals with OUD given all\n    of the tradeoffs just mentioned\n:::\n\n# Incremental CEA {background=\"black\"}\n\n# 1. Incremental CEA in Pictures\n\n## 1. Calculate incremental costs and effects\n\n::: incremental\n-   Often, a strategy capturing current practice ('status-quo', 'do\n    nothing', 'natural history') is defined.\n-   Costs and effects are then calculated for each strategy relative to\n    the status-quo.\n-   Plot the difference in costs and effects with health effects on\n    x-axis and cost effects on y-axis.\n:::\n\n## 1. Calculate cost and effects {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer1.png){fig-align=\"center\"}\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: nonincremental\n-   We can rule out any strategies that result in less health at higher\n    cost.\n:::\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer2.png){fig-align=\"center\"}\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   We can also rule out strategies where *some other competing\n    strategy* results in more (or equal) health at lower (or equal)\n    cost.\n-   This is known as \"strong\" dominance.\n:::\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer3.png){fig-align=\"center\"}\n\n## Identify Dominated Strategies {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer4.png){fig-align=\"center\"}\n\n## What about strategy B? {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer5.png){fig-align=\"center\"}\n\n## Hybrid Strategies\n\n::: incremental\n-   Suppose it is feasible to partially implement strategies **A** and\n    **D**.\n    -   For example, we could implement **A** for 90% of the population\n        and **D** for 10% of the population, or vice versa.\n:::\n\n## 90% A, 10% D\n\n![](images/vis_icer6a.png){fig-align=\"center\"}\n\n## 10% A, 90% D\n\n![](images/vis_icer6b.png){fig-align=\"center\"}\n\n## 50% A, 50% D {.smaller auto-animate=\"true\"}\n\n-   Can we make any statements about **B** now?\n\n![](images/vis_icer6c.png){fig-align=\"center\"}\n\n## Extended (Weak) Dominance {.smaller auto-animate=\"true\"}\n\n-   **B** is ruled out by extended (\"weak\") dominance.\n\n![](images/vis_icer7.png){fig-align=\"center\"}\n\n## Extended (Weak) Dominance {.smaller auto-animate=\"true\"}\n\n![](images/vis_icer8.png){fig-align=\"center\"}\n\n## Efficiency Frontier {.smaller auto-animate=\"true\"}\n\n::: nonincremental\n-   The efficiency frontier is the set of non-dominated strategies.\n:::\n\n![](images/vis_icer9.png){fig-align=\"center\"}\n\n## ICERs {.smaller auto-animate=\"true\"}\n\n-   The slope of a line connecting two points is the incremental\n    cost-effectiveness ratio comparing those strategies. More on this\n    later!\n\n![](images/vis_icer10.png){fig-align=\"center\"}\n\n# 2. Incremental CEA in Tables\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n</br> </br> </br> </br> </br>\n\n::: {.callout-important appearance=\"simple\"}\nPlease note that the following example uses different strategies and\nvalues than the example used in the previous pictures!\n:::\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: incremental\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^1]\n\n3.  Calculate ICER based on difference in costs and effects.\n\n4.  Determine dominated strategies (ICER\\<0).\n\n5.  Re-calculate ICERs after eliminating dominated strategies.\n\n6.  Determine strategies ruled out by extended dominance.\n\n7.  Re-calculate ICERs after ruling out all dominated strategies.\n\n8.  Repeat 5-7 as needed.\n:::\n\n[^1]: Least costly first, most costly last\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n[1. Calculate costs and effects for each strategy.]{.fragment\n.highlight-red}\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n```{r}\ndf %>% kable(col.names = c(\"Strategy\",\"Cost\",\"QALYs\"),format.args = list(big.mark = \",\"),digits = 3) %>% \n  kable_styling()\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n[2. Sort table by costs in ascending order.]{.fragment\n.highlight-red}[^2]\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n[^2]: [Least costly first, most costly last]{.fragment .highlight-red}\n\n```{r}\ndf_s %>% kable(col.names = c(\"Strategy\",\"Cost\",\"QALYs\"),format.args = list(big.mark = \",\"),digits = c(1,0,3)) %>% \n  kable_styling()\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^3]\n\n[3. Calculate ICER based on difference in costs and effects.]{.fragment\n.highlight-red}\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n[^3]: Least costly first, most costly last\n\n```{r}\ndf_i2 %>% select(-status) %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\"),format.args = list(big.mark = \",\"), digits = c(1,0,0,3,3,0)) %>% \n  kable_styling() %>% \n  column_spec(c(3,5), background = \"yellow\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^4]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n[4. Determine dominated strategies (ICER\\<0)]{.fragment .highlight-red}\n:::\n:::\n\n[^4]: Least costly first, most costly last\n\n```{r}\n# color.me <- which(df_i2$status == \"Dominated\")\n# df_i2  %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\")) %>% \n#   kable_styling() %>%\n#   row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   Let's take a look at our table.\n-   Notice that strategy E has a **negative** ICER. Why is this?\n-   Strategy E raises costs but lowers QALYs.\n-   Therefore, we'd be better off by selecting strategy C (we would get\n    more health gain for less money...)\n:::\n\n```{r}\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% \n  mutate(status = \"\") %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"),\n        digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   **Strong dominance** refers to situations where one strategy is\n    preferred over another on both costs and health effects (e.g.,\n    QALYs).\n-   When we identify a strongly dominated option, we remove it from the\n    table and re-calculate ICERS based on the remaining strategies.\n:::\n\n```{r}\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"),digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## A Brief Aside on Negative ICERs\n\n-   We want to rule out strategies that cost *more* but result in less\n    health.\n    -   This implies a negative ICER.\n-   But what other scenario would result in a negative ICER?\n    -   Strategy adds health but reduces costs.\n    -   This is a great strategy!\n\n## Both Strategies Have a Negative ICER\n\n![](images/vis_icer-negative.png){fig-align=\"center\"}\n\n## A Brief Aside on Negative ICERs\n\n-   For this reason, it is poor practice to report negative ICERs.\n-   Be careful when deleting a strategy becuase it has a negative ICER!\n    -   It may be a great strategy!\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^5]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n[4. Determine dominated strategies (ICER\\<0)]{.fragment .highlight-red}\n:::\n:::\n\n[^5]: Least costly first, most costly last\n\n```{r}\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^6]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n4.  Determine dominated strategies (ICER\\<0).\n\n[5. Re-calculate ICERs after eliminating dominated\nstrategies.]{.fragment .highlight-red}\n:::\n:::\n\n[^6]: Least costly first, most costly last\n\n```{r}\n\ncolor.me <- which(df_i2$status == \"Dominated\")\ndf_i2  %>% mutate(d_cost = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_cost)) %>%\n  mutate(d_effect = ifelse(status %in% c(\"Dominated\",\"Dominated (Extended)\"), NA, d_effect))  %>%\n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>%\n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^7]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n4.  Determine dominated strategies (ICER\\<0).\n\n5.  Re-calculate ICERs after eliminating dominated strategies.\n:::\n:::\n\n[^7]: Least costly first, most costly last\n\n```{r}\ncolor.me <- grep(\"DominatedXXXXX\",df_i3$status)\ndf_i3  %>% \n  mutate(status = \"\") %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: incremental\n-   We're not quite done yet\n-   Notice something odd about strategy B?\n-   Its ICER is **higher** than the next most costly alternative\n    (strategy D)\n:::\n\n```{r}\ncolor.me <- grep(\"B\",df_i3$strategy)\ndf_i3  %>% \n  mutate(status = \"\") %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#e5f536\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n-   A telltale sign of extended dominance in a (sorted) CEA table is a\n    strategy with a higher ICER than the next most expensive option.\n\n```{r}\ncolor.me <- grep(\"Dominated\",df_i3$status)\ndf_i3  %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Determining Dominated Strategies {.smaller auto-animate=\"true\"}\n\n::: nonincremental\n-   You can see this in the pictures as well ....\n:::\n\n![](images/vis_icer11.png){fig-align=\"center\"}\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Calculate costs and effects for each strategy.\n\n2.  Sort table by costs in ascending order.[^8]\n\n3.  Calculate ICER based on difference in costs and effects.\n:::\n\n::: {.column width=\"50%\"}\n4.  Determine dominated strategies (ICER\\<0).\n\n5.  Re-calculate ICERs after eliminating dominated strategies.\n\n[6. Determine strategies ruled out by extended dominance.]{.fragment\n.highlight-red}\n:::\n:::\n\n[^8]: Least costly first, most costly last\n\n```{r}\ncolor.me <- grep(\"Dominated\",df_i3$status)\ndf_i3  %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n## Incremental CEA {.smaller auto-animate=\"true\"}\n\n::: columns\n::: {.column width=\"50%\"}\n[7. Re-calculate ICERs after ruling out all dominated\nstrategies.]{.fragment .highlight-red}\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n```{r}\ncolor.me <- grep(\"Dominated\",df_i4$status)\ndf_i4  %>% kable(col.names = c(\"Strategy\",\"Cost\",\"dCost\",\"QALYs\",\"dQALYs\",\"ICER\",\"\"),format.args = list(big.mark = \",\"), digits = c(0,0,0,3,3,0,0)) %>% \n  kable_styling() %>%\n  row_spec(color.me, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n\n::: {style=\"font-size: 0.8em\"}\n-   Strategy D is more expensive than Strategy B, but Strategy D is\n    gaining health MORE EFFICIENTLY than Strategy B\n:::\n\n## In-class practice: DALYs {.smaller}\n\n**Nine** different prophylaxis to prevent someone with HIV from\nacquiring opportunistic infections related to AIDS\n\n::: {style=\"font-size: 0.8em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\ndf <- \n  tibble::tribble(\n                                          ~Strategy,      ~Cost, ~DALYs,\n                                   \"No prophylaxis\",  40288,  0,\n                                          \"TMP-SMX\",  44786,  2.56,\n                            \"TMP-SMX, azithromycin\",  45944,  3.04,\n                             \"TMP-SMX, fluconazole\",  47046,  3.01,\n               \"TMP-SMX, azithromycin, fluconazole\",  48596,   3.6,\n                             \"TMP-SMX, ganciclovir\",  54628,   3.2,\n               \"TMP-SMX, azithromycin, ganciclovir\",  56812,  3.83,\n                \"TMP-SMX, fluconazole, ganciclovir\",  58082,   3.8,\n  \"TMP-SMX, azithromycin, fluconazole, ganciclovir\",  61119,  4.62\n  ) %>% \n  mutate(DALYs = 9.5 - DALYs) %>% \n  mutate(iCost = c(0,diff(Cost))) %>% \n  mutate(DALYs_averted = -c(0,diff(DALYs))) %>% \n  select(Strategy, Cost, iCost,DALYs, everything())\n\ndf %>% \n  select(-DALYs_averted,-iCost) %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"DALYs\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling()\n```\n:::\n\n## Calculate Incremental Costs and DALYs Averted {.smaller}\n\n::: {style=\"font-size: 0.8em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"Incremental Cost\",\"DALYs\",\"DALYs Averted\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling() %>% \n  column_spec(c(3,5), background = \"yellow\")\n```\n:::\n\n## Calculate incremental costs per DALY averted. {.smaller}\n\n::: {style=\"font-size: 0.8em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf %>% \n  select(-Cost,-DALYs) %>% \n  mutate(iCost_per_DALY_averted = round(iCost/DALYs_averted,0)) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\"),\n        format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n    column_spec(c(4), background = \"yellow\")\n```\n:::\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf1 <- \n  df %>% \n  mutate(cost_per_daly_averted = iCost/DALYs_averted) %>% \n  mutate(status = ifelse(cost_per_daly_averted <0 , \"Dominated (Strong)\",\"\")) %>% \n  mutate(status = ifelse(is.na(status),\"\",status)) \n\ncolor.me.red <- which(df1$status == \"Dominated (Strong)\")\n\ndf1 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n    select(-Cost,-DALYs) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n:::\n\n# Remove dominated strategies and recalculate\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf2 <- \n  df1 %>% \n  group_by(status) %>% \n  nest()  %>% \n  filter(status==\"\") %>% \n  unnest(cols = c(data)) %>% \n  arrange(Cost) %>% \n  mutate(iCost = c(0,diff(Cost))) %>% \n  mutate(DALYs_averted = -c(0,diff(DALYs))) %>% \n  mutate(cost_per_daly_averted = iCost/DALYs_averted) %>% \n  mutate(status = ifelse(cost_per_daly_averted <0 , \"Dominated (Strong)\",\"\")) %>% \n  mutate(status = ifelse(cost_per_daly_averted > lead(cost_per_daly_averted), \"Dominated (Extended)\",status)) %>% \n  mutate(status = ifelse(is.na(status),\"\",status)) %>% \n  ungroup()\n\ndf2 %>% \n  select(Strategy,Cost,iCost,DALYs,DALYs_averted) %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"Incremental Cost\",\"DALYs\",\"DALYs Averted\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling()\n```\n:::\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\n\ncolor.me.red <- which(df2$status == \"Dominated (Strong)\" | df2$status == \"Dominated (Extended)\")\n\ndf2 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n  select(Strategy,iCost,DALYs_averted,cost_per_daly_averted,status) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n:::\n\n# Remove dominated strategies and recalculate\n\n## Determine dominated strategies {.smaller}\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\ndf3 <- \n  df2 %>% \n  group_by(status) %>% \n  nest()  %>% \n  filter(status==\"\") %>% \n  unnest(cols = c(data)) %>% \n  arrange(Cost) %>% \n  mutate(iCost = c(0,diff(Cost))) %>% \n  mutate(DALYs_averted = -c(0,diff(DALYs))) %>% \n  mutate(cost_per_daly_averted = iCost/DALYs_averted) %>% \n  mutate(status = ifelse(cost_per_daly_averted <0 , \"Dominated (Strong)\",\"\")) %>% \n  mutate(status = ifelse(cost_per_daly_averted > lead(cost_per_daly_averted), \"Dominated (Extended)\",status)) %>% \n  mutate(status = ifelse(is.na(status),\"\",status)) %>% \n  ungroup()\n\ndf3 %>% \n  select(Strategy,Cost,iCost,DALYs,DALYs_averted) %>% \n  kable(col.names = c(\"Strategy\",\"Cost\",\"Incremental Cost\",\"DALYs\",\"DALYs Averted\"),format.args = list(big.mark = \",\")) %>% \n  kable_styling()\n```\n:::\n\n## Determine dominated strategies {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\n\n\ncolor.me.red <- which(df3$status == \"Dominated (Strong)\" | df3$status == \"Dominated (Extended)\")\n\ndf3 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n select(Strategy,iCost,DALYs_averted,cost_per_daly_averted,status) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\")\n```\n:::\n\n## Final Table {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\ndf4 <- \n  df3 %>%\n  bind_rows(df1 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%\n bind_rows(df2 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%  \n  mutate(cost_per_daly_averted = ifelse(status==\"\",cost_per_daly_averted,NA)) %>% \n  select(Strategy, iCost, DALYs_averted, cost_per_daly_averted, status)\n\ncolor.me.red <- which(df4$status == \"Dominated (Strong)\" | df4$status == \"Dominated (Extended)\")\n\ndf4 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") \n\n```\n:::\n\n## A note on COMPARATORS\n\n![](images/comparator1.png){width=\"564\"}\n\n::: notes\n-   \\*\\*The comparators are REALLY IMPORTANT\n-   Ideally, you want to identify ALL POSSIBLE interventions applicable\n    to the problem, including a \"do nothing\" option\n:::\n\n## A note on COMPARATORS\n\n![](images/comparator2.png){width=\"527\"}\n\n::: notes\n-   \\*\\*The results can be DECEPTIVE if you decide to omit any\n    comparators that are relevant to clinical practice\n\n-   FOR EXAMPLE, if you purposefully pick a \"no treatment\" comparator\n    but leave out a closer alternative, then the analysis will grossly\n    overstate the economic value of the drug you are assessing\n\n-   Same goes with an expensive & not very effective alternative & you\n    leave out options that are similar in effectiveness & cost\n:::\n\n# Where to draw the line? {background=\"#43464B\"}\n\n::: notes\n-   What CEA cannot tell us is HOW TO SPEND\n:::\n\n## CEA Thresholds\n\n::: incremental\n-   So now we have our ICERs, but how do we make a decision?\n-   We must define a **threshold** ($\\lambda$), or an ICER value that\n    determines whether or not we implement a given strategy.\n    -   Also known as \"willingness-to-pay\" (WTP) threshold.\n:::\n\n## CEA Thresholds\n\nWhat are common thresholds and how are they determined?\n\n::: incremental\n-   In high income countries, common thresholds are \\$50,000/QALY,\n    \\$100,000/QALY, and \\$100,000/QALY.\n-   In LMICs, 0.5-3x per capita gross domestic product (GDP) per DALY\n    averted.\n-   More on this in a few minutes.\n:::\n\n## How do CEA Thresholds Guide Decisionmaking?\n\n![](images/vis_wtp.png){fig-align=\"center\" width=\"469\"}\n\n## How do CEA Thresholds Guide Decisionmaking?\n\n![](images/vis_wtp2.png){fig-align=\"center\" width=\"469\"}\n\n## How do CEA Thresholds Guide Decisionmaking?\n\n![](images/thresholds1.png){fig-align=\"center\" width=\"469\"}\n\n::: notes\n(1) How do we know whether something is \"high-value\" versus \"low-value\"\n    or \"no-value\" healthcare?\n\n(2) Let's say we are comparing flu vaccination versus no vaccination &\n    that our cost-effectiveness ratio yields a price per unit benefit of\n    \\$90,000 / QALY gained\n\n(3) \\[ASK CLASS\\] - Would this be considered \"high-value\"?\n\n(4) This price must be compared to a benchmark or threshold representing\n    either what society is willing to pay for health gains or the\n    opportunity costs associated with displacing interventions within a\n    fixed budget\n\n(5) In the US, the benchmark is ROUGHLY around \\$100,000/QALY based on\n    willingness to pay estimates\n\n(6) A threshold's assumed value is really important because it\n    ultimately determines how society should invest in care, which\n    ultimately impacts overall population health.\n\n(7) Anything above this benchmark would be considered cost-Ineffective\n    (low value care)\n\n(8) Anything below would be considered high-value (gaining each\n    quality-adjusted life-year at a lower cost)\n\n(9) Anything to the left is NO value care\n\n(10) This is really important because... \\*\\*\\*Resources invested in low\n     or no-value interventions could be better applied to more effective\n     prevention and treatment strategies that will yield higher\n     population health outcomes.\n:::\n\n## CEA Thresholds {.smaller}\n\n![](images/vis_icer12.png){fig-align=\"center\"}\n\n## CEA Thresholds {.smaller}\n\n![](images/vis_icer13.png){fig-align=\"center\"}\n\n## CEA Thresholds {.smaller}\n\n![](images/vis_icer14.png){fig-align=\"center\"}\n\n## CEA Thresholds {.smaller}\n\n![](images/thokala.png)\n\nDifferent ways thresholds have been estimated: - \"supply-side\" (UK &\nEurope) - \"demand-side\" (US) - per capita consumption (US/LMICs)\n\n::: notes\n(1) There are different ways to determine a cost-effective threshold &\n    it's done a bit differently around the world, which we talk about in\n    a recent paper I collaborated with UK colleagues on, which discusses\n    the evolution of these thresholds.\n\n(2) Some countries like the UK, use what has been referred to as a\n    \"supply-side threshold\" -- which represents the notion of\n    opportunity cost -- whether the health generated from an adopted\n    intervention from NICE, for instance, is greater than the health\n    that could have been generated if the money had been spent on\n    something else - Under a fixed budget.\n\n(3) Another way that countries like the US have defined CE thresholds is\n    by what's called a \"demand-side\" perspective, or society's\n    \"willingness to pay\" for health gains. There's still an opportunity\n    cost associated with this but it's from the perspective of the goods\n    & services we would be willing to forego for these additional health\n    gains.\n\n(4) Similarly, another way that countries have looked at the threshold\n    is in terms of per capita consumption - consistent with the idea\n    that people living in countries with higher incomes are able and\n    willing to pay more for health - which makes intuitive sense\n:::\n\n## Opportunity cost (\"supply-side\") {.smaller}\n\n<br>\n\n::: incremental\n-   Decision should be informed by the value of what will be given up as\n    a consequence of those cost.\n\n    -   Known as the \"opportunity cost.\"\n\n-   If resources are committed to the funding of one intervention, then\n    they are not available to fund and deliver others **(shopping spree\n    concept)**\n\n-   The opportunity cost of a commitment of resources is the health\n    forgone because these \"other\" interventions that are available to\n    the health system cannot be delivered.\n\n-   Source: See K Claxton on the estimation of the NICE threshold in the\n    UK / Woods et al, & others\n:::\n\n## Opportunity cost (\"supply-side\") {.smaller}\n\n![](images/thresholds2.png)\n\n::: notes\n(1) This is the closest to a \"supply-side\" CEA estimate that the US has\n    approached\n(2) This simulation looked at the Opportunity Cost attributed to persons\n    dropping health insurance due to health insurance premium increases\n    (which often happens when intervention costs are very high -- it's\n    often the consumers that bear the burden)\n(3) The authors found that the threshold should be around \\$100,000/QALY\n    gained (which is typically what we use in the US)\n(4) But UK academics would argue that this isn't a true opportunity cost\n    estimate because it doesn't evaluate the opportunity cost of\n    displacing interventions for other more effective (but often more\n    costly) alternatives --\n\n-   either within the health care sector or displacing other programs in\n    other sectors because of how much we spend on health care\n-   & there's many other things to consider such as effect of increasing\n    healthcare costs on patient copays, wait times, generosity of\n    employer plans, or on public insurance\n:::\n\n## Opportunity cost (\"supply-side\") {.smaller}\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n> If you don't consider the budget under which you are operating, then\n> some medications could take up half the budget and displace\n> interventions that produce significant health gain OR in the US, could\n> increase premiums or take away \\$\\$ from other sectors\n\n> Academics have argued that the threshold should be lower/on the more\n> conservative end for higher priced therapies (NICE uses a budget\n> impact threshold of 20,000 GBP/QALY for these higher priced therapies\n> as opposed to 30,000 GBP/QALY for others)\n:::\n\n## Willingness to pay (\"demand-side\")\n\n![](images/thresholds3.png)\n\n::: notes\n(1) Given that our health system is more complicated & we don't\n    necessarily have a \"fixed\" budget, per se, the US has largely\n    defined thresholds based on what is often referred to as\n    \"demand-side\" or \"willingness-to-pay\" criteria, which can also be\n    represented as the willingness to forego other types of consumption\n    to improve one's health.\n\n(2) This willingness to pay has been derived through surveys & also what\n    Medicare has been willing to pay for interventions\n\n(3) Some have argued that understanding a population's willingness to\n    pay is important, especially in a single-payer system that is funded\n    through social insurance -- ensuring that individuals have a role in\n    decision-making\n\n(4) But there is huge variation in willingness to pay studies - varied\n    substantially by condition, especially those for extending or saving\n    life (higher WTP).\n\n(5) This very short perspective piece gives an overview of the\n    thresholds we have used in the US in the past & what they are\n    largely based on (has largely been arbitrary) -- it's 2 pages &\n    would recommend reading\n:::\n\n## CEA Thresholds in LMICs\n\n![](images/thresholds4.png)\n\n::: notes\n(1) Other thresholds that countries have used are based on per capita\n    GDP; mainly the threshold of 1-3X per capita GDP\n\n(2) Although this threshold range roughly corresponds to what has become\n    convention for high-income countries (1X per capita GDP in the US is\n    around \\$60,000 & 3 times that is the upper end of what we use --\n    typically use 50,000 as lower end, 100,000 as the base, and 150,000\n    as an upper end)\n\n(3) BUT per capita consumption in wealthier countries exceeds the per\n    capita consumption in low & middle-income countries by one-to-two\n    orders of magnitude & therefore, some analysts have argued that\n    healthcare spending should represent a smaller portion of per capita\n    GDP in low to middle income countries.\n:::\n\n## CEA Thresholds in LMICs {.smaller}\n\n<br>\n\n::: incremental\n-   Past WHO guidelines recommended countries use following guidelines:\n    An intervention is cost-effective if cost/DALY averted is less than\n    1-3X per capita GDP of country\n-   Some have argued the WHO's guidelines may be too high and result in\n    adoption of interventions that displace existing services that\n    provide greater health benefit.\n-   Suggest 0.5 GDPpc is a more appropriate benchmark for low-income\n    countries and 0.71 GDPpc for middle-income countries (see Woods et\n    al 2016)\n:::\n\n::: notes\n(1) Analysts have also argued that the threshold should be lower for\n    these countries based on a healthcare budget perspective\n\n(2) In Peru, for example, a study found that the addition of one breast\n    cancer treatment could be cost-effective under the broad 1-3X per\n    capita GDP criteria; however, the cost of adding the new drug would\n    exceed Peru's entire budget for breast cancer treatment.\n:::\n\n## CEA Thresholds in LMICs\n\n![](images/thresholds5.png)\n\n::: notes\n(1) You can see from my paper on this --\n\n(2) We found:\n\n-   The proportion of PUBLISHED studies citing a threshold of 1-3X per\n    capita GDP has increased over time & this largely corresponds to the\n    WHO recognition of this threshold in the early 2000s -- prior to\n    this, most studies either cited no threshold or other CE thresholds\n\n-   The WHO has since moved away from recommended this threshold since\n    it has received A LOT of backlash, including from my paper\n\n(3) Until we come up with a better measure, the DSP3 & other academics\n    have estimated more conservative thresholds (previous slide) that I\n    would use for LMICs & would NOT use the per capita assumptions\n\n(4) But we still don't have a perfect threshold estimate\n:::\n\n## HIV Example From Earlier {.smaller}\n\n::: {style=\"font-size: 0.7em\"}\n```{r}\ndf4 <- \n  df3 %>%\n  bind_rows(df1 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%\n bind_rows(df2 %>%\n              group_by(status) %>%\n              nest()  %>%\n              filter(status != \"\") %>%\n              unnest(cols = c(data))) %>%  \n  mutate(cost_per_daly_averted = ifelse(status==\"\",cost_per_daly_averted,NA)) %>% \n  select(Strategy, iCost, DALYs_averted, cost_per_daly_averted, status)\n\ncolor.me.red <- which(df4$status == \"Dominated (Strong)\" | df4$status == \"Dominated (Extended)\")\n\ndf4 %>% \n  mutate(cost_per_daly_averted = round(cost_per_daly_averted,0)) %>% \n  kable(col.names = c(\"Strategy\",\"Incremental Cost\",\"DALYs Averted\", \"Incremental Cost per DALY Averted\", \"Status\"),format.args = list(big.mark = \",\")) %>%\n  kable_styling() %>% \n  row_spec(color.me.red, bold = T, color = \"black\", background = \"#FCD2CA\") \n\n```\n:::\n\n## HIV Example from Earlier {.smaller}\n\n<br>\n\n-   If our CE threshold was 2x GDP (GDP = \\$2,500), which option would\n    we choose as decision makers?\n-   If our CE threshold was 1x GDP (GDP = \\$2,500), which option would\n    we choose as decision makers?\n\n# Next: ICER Case Study {background=\"#43464B\"}\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":"katex","slide-level":2,"to":"revealjs","incremental":false,"highlight-style":"ayu-mirage","output-file":"lec_6.ICERs.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":false,"quarto-version":"1.8.24","auto-stretch":true,"title":"Incremental Cost-Effectiveness Analysis","editor_options":{"chunk_output_type":"console"},"editor":{"markdown":{"wrap":72}},"theme":"slides.scss","slideNumber":true,"logo":"../vchem.png","transition":"fade","backgroundTransition":"fade","footer":"[Back to Website](../index.html)\n"}}},"projectFormats":["html"]}