{"title":"Bayes’ Theorem & Probability Revision","markdown":{"yaml":{"title":"Bayes’ Theorem & Probability Revision","format":{"revealjs":{"theme":"slides.scss","incremental":true,"slide-number":true,"logo":"../vchem.png","html-math-method":"katex","transition":"fade","background-transition":"fade","highlight-style":"ayu-mirage","footer":"[Back to Website](../index.html)\n"}},"editor_options":{"chunk_output_type":"console"},"editor":"source"},"headingText":"Learning Objectives and Outline","containsRefs":false,"markdown":"\n\n\n## Learning Objectives\n\n-   Recognize the importance of Bayes' Theorem within a Decision\n    Analysis context\n\n-   Reproduce Bayes' within context of sensitivity/specificity/positive\n    & negative predictive values\n\n\n## Medical Testing\n\n<br>\n\n**Testing is done for:**\n\n-   Screening (primary prevention)\n\n-   Diagnosis (secondary prevention)\n\n-   Monitor and guide treatment (tertiary prevention)\n\n-   Prognosis\n\n::: notes\nKeeping Bayes' Theorem in mind, let's jump into diagnostic testing &\nthen we will see how we would apply Bayes' theorem within the context of\ntest results\n\nMEDICAL TESTING is done for --\n\nScreening as it relates to primary prevention EX: HPV screening for\ncervical cancer prevention\n\nDiagnosis, or secondary prevention EX: Diagnosis of Hepatitis C, which\nthe earlier diagnosis the better in terms of the disease getting worse\nover time\n\nTo monitor & guide treatment (otherwise known as tertiary prevention)\nEX: Diabetes could be a good example of this -- the goal is to improve\nquality of life by limiting or delaying complications, restoring\nfunction, etc.\n\nTo make a prognosis EX: The likely course of a disease\n:::\n\n## Information for decision making\n\n<br>\n\n**Clinicians have a variety of diagnostic information to guide their\ndecision making**\n\n-   Talking to patient (history, symptoms)\n\n-   Physically examining patient\n\n-   Screening (cervical cancer) + diagnostic tests (EKGs, Blood tests,\n    X-rays)\n\n## Information for decision making\n\n<br>\n\nObtaining information can be...\n\n::: incremental\n-   RISKY <br>\n\n-   EXPENSIVE <br>\n\n-   ERROR PRONE <br>\n\n-   ALL THREE\n:::\n\n::: notes\nRISKY/INVASIVE -- For example, getting an Amniocentesis during pregnancy\n(A medical procedure used primarily in prenatal diagnosis of chromosomal\nabnormalities and fetal infections) can significantly increase one's\nrisk of a miscarriage.\n\nEXPENSIVE -- An MRI, for example, is pricey\n\nERROR PRONE -- Diagnostic tests, like anything, aren't perfect; though,\nsome are more perfect than others\n\nALL THREE --A diagnostic test, for example, could be all three -- risky,\nexpensive, & not very precise\n\n\\*\\*We need to factor in these tradeoffs when making decisions\n:::\n\n## Role of Decision Analysis Methods\n\n- Can be used to weigh the costs and benefits: \n  - Test costs\n  - Test accuracy\n  - Health risks of testing\n\n## Example: Diagnostic Tests\n\nWhat is the chance that a patient has a disease if a diagnostic test is positive\nor negative? <br>\n\n\n## Example: Diagnostic Tests\n\nWhat is the chance that a patient has a disease if a diagnostic test is positive\nor negative? <br>\n\nIn other words, what is the probability of disease conditional on the\ntest result? (D+ \\| T+); (D+ \\| T-)\n\n## Ways to get revised (posterior) probabilities\n\n\n<br>\n\n1.  Bayes' theorem <br>\n2.  2x2 tables <br>\n3.  Bayes' theorem via decision tree inversion  <br>\n\n## Ways to get revised (posterior) probabilities\n\n::: nonincremental\n<br>\n\n1.  [Bayes' theorem]{style=\"background-color: yellow;\"}  <br>\n2.  2x2 tables <br>\n3.  Bayes' theorem via decision tree inversion  <br>\n\n:::\n\n# 1. Bayes' Theorem: Intuition {background=\"#43464B\"}\n\n## Population of 200 indiviudals\n\n\n![](images/bayes_test1.png){height=600 fig-align=\"center\"}\n\n\n## Disease (red) has 1% prevalence.\n\n\n![](images/bayes_test2.png){height=600 fig-align=\"center\"}\n\n\n## A Screening Test is Available\n\n::: {layout=\"[[-1], [-1], [1], [-1]]\"}\n![](images/bayes_test.png){height=100 fig-align=\"center\"}\n:::\n\n\n## Test will detect 100% of positive cases.\n\n![](images/bayes_test3a.png){height=600 fig-align=\"center\"}\n\n\n## 3% of disease-free individuals will test positive {.smaller}\n\n![](images/bayes_test3.png){height=520 fig-align=\"center\"}\n\n\n## Eight Positive Tests\n\n\\vspace{4em}\n\n::: {layout=\"[[-1],[-1], [-1], [1], [-1]]\"}\n\n![](images/bayes_test4.png){height=100 fig-align=\"center\"}\n:::\n\n## Probability of Disease Given Positive Test\n\n::: {layout=\"[[-1],[-1],  [1], [-1]]\"}\n\n![](images/bayes_test5.png){height=80% fig-align=\"center\"}\n:::\n\n## Key Points\n\n- While the test *always* detects a true case, it also returns false positives.\n- The higher the number of false positives, the lower the probability that a given positive result is actually an individual with the disease.\n\n## False Positives\n\n- Could be the result of a poor test (e.g., 3% false positive rate).\n- Or could be the result of a disease with very low prevalence in a large population, but a very good test!\n  - In a population of 200 million, a test with a 0.01% false positive rate will yield 20,000 false positive readings!\n  - If the disease prevalence is low (e.g., 0.001%, or 2,000 sick individuals), the probability that someone is sick if they test positive is <10%!\n\n\n# Bayes' Theorem: Theory {background=\"#43464B\"}\n\n## Probability of B\n\n::: columns\n::: {.column}\n$$\nPr(B) \n$$\n:::\n::: {.column}\n![](images/conditional-1.png)\n:::\n:::\n\n## Probability of A and B\n\n::: columns\n::: {.column width=\"60%\"}\n$$\n\\begin{aligned}\nPr(A \\& B) &= Pr(A|B) Pr(B)\\\\\n&= Pr(B|A) Pr(A)\n\\end{aligned}\n$$\n:::\n::: {.column width=\"30%\"}\n![](images/conditional-2.png)\n:::\n:::\n\n\n\n## Probability of A Given B\n\n::: columns\n::: {.column}\n$$\nPr(A|B) = \\frac{Pr(A \\& B)}{Pr(B)}\n$$\n:::\n::: {.column}\n![](images/conditional-3.png)\n:::\n:::\n\n\n\n\n\n## A Perfect Test\n\n![](images/bayes1.png){height=600 fig-align=\"center\"}\n\n## 100% Specificity, <100% Sensitivity\n\n![](images/bayes2.png){height=600 fig-align=\"center\"}\n\n## <100% Specificity, 100% Sensitivity\n\n![](images/bayes3.png){height=600 fig-align=\"center\"}\n\n\n## Let's Lower Disease Prevalence\n\n![](images/bayes4.png){height=600 fig-align=\"center\"}\n\n## <100% Specificity, <100% Sensitivity\n\n![](images/bayes5.png){height=600 fig-align=\"center\"}\n\n# What is the Probability of Disease Given A Positive Test? {background=\"#43464B\"}\n\n## Probability of Testing Positive if Have Disease\n\n::: columns\n\n::: {.column}\n::: {layout=\"[[-1],  [1], [-1]]\"}\n![](images/bayes5.png){height=250 fig-align=\"center\"}\n:::\n:::\n\n::: {.column}\n::: {layout=\"[[-1], [-1], [1], [-1]]\"}\n\n![](images/bayes_PrPosBarDisesase.png){height=50 fig-align=\"center\"}\n:::\n:::\n:::\n\n\n## Probability of Having the Disease\n\n::: columns\n\n::: {.column}\n::: {layout=\"[[-1],  [1], [-1]]\"}\n![](images/bayes5.png){height=300 fig-align=\"center\"}\n:::\n:::\n\n::: {.column}\n\n![](images/bayes_PrDisease.png){height=300 fig-align=\"center\"}\n:::\n\n:::\n## Probability of a Positive Test\n\n::: columns\n\n::: {.column}\n::: {layout=\"[[-1],  [1], [-1]]\"}\n![](images/bayes5.png){height=300 fig-align=\"center\"}\n:::\n:::\n\n\n::: {.column}\n![](images/bayes_PrPos.png){height=300 fig-align=\"center\"}\n:::\n:::\n\n## Bayes' Theorem\n\n::: columns\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_theorem_.png)\n:::\n:::\n\n:::{.column}\n![](images/bayes_theorem.png){fig-align=\"center\" height=\"600px\"}\n:::\n\n:::\n\n\n::: notes\n(1) Bayes theorem describes the probability of an event BASED ON the\n    PRIOR knowledge of conditions that might be related to the event\n\n(2) When conducting decision analyses in real life, sometimes, the\n    probability of A given B is easier to get (or vice versa) and you're\n    not able to find the probability of B given A. So, you can use\n    Bayes' theorem to convert probabilities into what you need based on\n    the data you have in the real world\n\n(3) Conditional probabilities are related according to Bayes' theorem --\n    in other words, it is a way to RELATE conditional probabilities\n\n(4) Explain how to get to Bayes equation\\*\\*\\* NOTE: Pr(B) cannot be 0\n    and Pr(A) cannot be 0 or it becomes undefined\n:::\n\n## {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\"}\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population0.png)\n:::\n:::\n\n\n:::\n\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population1.png)\n:::\n\n:::\n\n\n\n:::\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population2.png)\n:::\n\n:::\n\n\n\n:::\n\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population3.png)\n:::\n\n:::\n\n\n\n:::\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population3.png)\n![](images/bayes_population4.png)\n:::\n\n:::\n\n\n\n:::\n\n# 2. 2x2 Tables {background=\"#43464B\"}\n\n## 2x2 Example: Disease Testing\n\n**Case example**\n\nYou are trying to determine what proportion of the\npopulation has already been exposed a new communicable disease, in hopes of figuring out\nif herd immunity is possible.\n\n<br>\n\nYou decide to do a  antibody test to measure the level of\nantibodies [in a sample of 500 participants]{style=\"background-color: yellow;\"}\n\n## Disease Testing\n\n<br>\n\n**Case example**\n\nWhat is the test's SENSITIVITY? <br>\n\nWhat is the test's SPECIFICITY? <br>\n\nWhat is the test's FALSE NEGATIVE RATE? <br>\n\nWhat is the test's FALSE POSITIVE RATE? <br>\n\n## Disease Testing\n\n<br>\n\n**Case example**\n\n::: {style=\"font-size: 0.8em\"}\n|      | *D+*   | *D-*   |               |\n|------|--------|--------|---------------|\n| *T+* | a (TP) | b (FP) | a + b         |\n| *T-* | c (FN) | d (TN) | c + d         |\n|      | a + c  | b + d  | a + b + c + d |\n:::\n\n::: notes\nOne way we can look at these different testing outcomes is through a 2X2\ntable\n:::\n\n## Disease Testing: SENSITIVITY\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n|      | *D+*            | *D-*        |                     |\n|------|-----------------|-------------|---------------------|\n| *T+* | **125** (a, TP) | 20 (b, FP)  | 145 (a + b)         |\n| *T-* | 9 (c, FN)       | 346 (d, TN) | 355 (c + d)         |\n|      | **134** (a + c) | 366 (b + d) | 500 (a + b + c + d) |\n:::\n\n<br> Test Sensitivity among those who have or had the virus, [125/134 =\n93%]{style=\"background-color: yellow;\"} (Interpretation: The probability\nof the screening test correctly identifying diseased subjects was 93%)\n\n::: notes\n(1) **Sensitivity** measures how often a test correctly generates a\n    positive result for people who had the condition that's being tested\n    for (also known as the \"true positive\" rate).\n\n(2) We would take column A (which is the proportion of people who have a\n    positive COVID antibody test & divide that by everyone who truly had\n    COVID) --\n\n(3) As a result, we would get the proportion of people that previously\n    HAD COVID with a TRUE POSITIVE test\n\n*(to determine those who \"truly\" had COVID, the study criteria could\nhave included individuals who had received a range of other confirmatory\ntests while they had COVID, including lung examinations, other blood\nwork, etc.)*\n\n(4) For this example, we get a test sensitivity of 93%\n\n(5) **In other words, a test with 93% sensitivity will correctly return\n    a positive result for MOST people who have had COVID BUT will return\n    a negative result --- a false-negative --- for 7% of the people who\n    have had COVID & should have tested positive**\n:::\n\n## Disease Testing: SENSITIVITY\n\n![](images/sensitivity.png)\n\n## Example: SPECIFICITY\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n|      | *D+*        | *D-*            |                     |\n|------|-------------|-----------------|---------------------|\n| *T+* | 125 (a, TP) | 20 (b, FP)      | 145 (a + b)         |\n| *T-* | 9 (c, FN)   | **346** (d, TN) | 355 (c + d)         |\n|      | 134 (a + c) | **366** (b + d) | 500 (a + b + c + d) |\n:::\n\n<br> Test Specificity among those without the disease at any point,\n[346/366 = 95%]{style=\"background-color: yellow;\"} (Interpretation: The\nprobability of the screening test correctly identifying non-diseased\nsubjects was 65%)\n\n::: notes\n(1) **Specificity** measures a test's ability to correctly generate a\n    **negative result** for people **who don't have the condition** (or\n    didn't have the condition in our case) that's being tested for (also\n    known as the \"true negative\" rate).\n\n(2) To calculate the SPECIFICITY of the antibody test, we would take\n    column D (which is the proportion of people who tested negative for\n    COVID antibodies & divide that by everyone who **truly** did NOT\n    have COVID\n\n(3) When we do the calculation, the probability of the antibody test\n    correctly identifying those that DID NOT previously have COVID was\n    95%\n\n(4) **In other words, a test with 95% specificity will correctly return\n    a negative result for MOST people who didn't have the disease BUT\n    will return a positive result --- a false-positive --- for 5% of the\n    people who didn't have COVID and should have tested negative for the\n    antibodies**\n:::\n\n\n## Disease Testing: SPECIFICITY\n\n![](images/specificity.png)\n\n# Do you want a test with good Sensitivity or good Specificity? {background=\"#43464B\"}\n\n::: notes\nIT DEPENDS!\n\nEXAMPLE -- HIV TEST\n\nIf low SENSITIVITY, you have the risk of producing a lot of\nfalse-negatives, which could be bad for the population & the spread of\nthe virus + patient not getting the care he/she needs; Not picking up\nthe disease in people who should be picked up\n\nIf low SPECIFICITY, there's an increase risk of false-positive results,\nwhich can be devastating & lead to toxicity implications (if you start\ntreatment) + grave emotional consequences + increase healthcare costs\nFalsely returning positive tests in people that don't have the disease\n:::\n\n## False Negatives\n\n<br>\n\n[False negative rate (1-sensitivity)]{style=\"color: #169873;\"} is the\nproportion of diseased people with a negative test: c/(a+c)\n\n## False Negatives{background-image=\"images/false-negative.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n<br>\n\n[False negative rate (1-sensitivity)]{style=\"color: #169873;\"} is the\nproportion of diseased people with a negative test: c/(a+c)\n\n## False Negatives{background-image=\"images/false-negative.png\" data-background-size=\"contain\" background-opacity=\"1.0\"}\n \n \n\n## False Positives\n\n<br>\n\n[False positive rate (1-specificity)]{style=\"color: #169873;\"} is the\nproportion of non-diseased people with a positive test: b/(b+d)\n\n## False Negatives{background-image=\"images/false-positive.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n<br>\n\n[False positive rate (1-specificity)]{style=\"color: #169873;\"} is the\nproportion of non-diseased people with a positive test: b/(b+d)\n\n## False Negatives{background-image=\"images/false-positive.png\" data-background-size=\"contain\" background-opacity=\"1.0\"}\n\n# Bayes' Theorem With Tree Inversion {background=\"#43464B\"}\n\n## Bayes' theorem with tree inversion\n\n![](images/inversion1.png){fig-align=\"center\" height=\"400px\"}\n\n::: notes\n-   Another way that we can revise probabilities based on the\n    information we have to work with is inverting the tree\n\n-   We often have information on the P(T+ \\| D+) (tree to the right);\n    but mathematically, the tree to the left is the same, but it might\n    be easier to construct the tree this way given the information you\n    have\n:::\n\n## Goal: \"Flip\" The Tree\n\n![](images/inversion2.png){fig-align=\"center\" height=\"600px\"}\n\n## Start Matching Terminal Numbers ... \n\n![](images/inversion3.png){fig-align=\"center\" height=\"600px\"}\n\n## Continue Matching Terminal Numbers ... \n\n![](images/inversion4.png){fig-align=\"center\" height=\"600px\"}\n\n## Continue Matching Terminal Numbers ... \n\n![](images/inversion5.png){fig-align=\"center\" height=\"600px\"}\n\n## Work Your Way Down the Tree ... \n\n![](images/inversion6.png){fig-align=\"center\" height=\"600px\"}\n\n## Inverted Tree\n\n![](images/inversion7.png){fig-align=\"center\" height=\"600px\"}\n\n## Probability of Disease Given + Test\n\n![](images/inversion8.png){fig-align=\"center\" height=\"600px\"}\n\n## Probability of Disease Given - Test\n\n![](images/inversion9.png){fig-align=\"center\" height=\"600px\"}\n\n## Conclusions\n\n::: incremental\n-   We are often bayesian in how we think\n-   Knowledge of test characteristics can help you to make more informed\n    decisions\n-   In general, diagnostic tests are helpful when pre-test prob is in\n    the middle (30-70%) and test is going to move you past a decision\n    threshold\n-   Tests with very good characteristics (ex. 100% sens or spec) can\n    also be very useful if used appropriately\n:::\n\n::: notes\n(1) You don't realize it but you're already thinking about these ratios\n    in your head\n\n-   If you're a surgeon and someone comes in and says that their stomach\n    hurts, you have a certain probability in your mind that they have\n    appendicitis\n-   Everyday life and other professions -- Personality tests, who will\n    benefit from education intervention; Autism screening\n\n(2) Pre-test probability is a big deal because you don't want to do an\n    expensive test with a low pre-test probability, BUT once you find\n    additional information then that can change\n:::\n\n\n# [Extra] Likelihood Ratios {background=\"#43464B\"}\n\n## Likelihood ratio\n\n<br>\n\n::: {.callout-important appearance=\"minimal\" icon=\"false\"}\nUseful for situations in which a quick estimate of revised probabilities\nis needed\n:::\n\n> Likelihood that a given test result would be expected in a patient\n> with the **target disorder Pr(test result \\| D+) compared to** the\n> likelihood that the same result would be expected in a patient\n> **without the target disorder Pr(test result \\| D-)** \\[A RATIO\\]\n\n## Likelihood ratios\n\n<br>\n\nThe likelihood ratio (LR) summarizes test sensitivity and specificity\n[into one number:]{style=\"color: forestgreen;\"} <br>\n\n::: {.callout-important appearance=\"minimal\" icon=\"false\"}\nLR (positive test) = sensitivity/1-specificity (or TPR/FPR)\n:::\n\n::: {.callout-important appearance=\"minimal\" icon=\"false\"}\nLR (negative test) = 1-sensitivity/specificity (or FNR/TNR)\n:::\n\n## Likelihood ratios\n\n-   LR can be used to revise disease probabilities using the following\n    form of Bayes' Theorem:\n\n> Post-test odds = Pretest odds x LR\n\n-   The odds that the patient has the target disorder, after the test\n    results are known. It is calculated by multiplying the pre-test odds\n    by the likelihood of a positive or negative test.\n\n::: notes\n(3) In other words, the post-test odds are the odds that the patient has\n    the target disorder AFTER the test results are known\n:::\n\n## Likelihood ratios\n\n<br>\n\n-   LR's are an advance beyond 2x2 tables\n\n-   To use likelihood ratios, you must be comfortable converting between\n    probabilities of disease and odds of disease\n\n-   Odds are simply another way of describing the chances that something\n    will (or won't) happen\n\n## Likelihood ratios\n\n<br>\n\n$$ Odds of Disease = \\frac{\\text{Probability}}{\\text{1 - Probability}}$$\n<br>\n\n$$ Probability = \\frac{\\text{Odds}}{\\text{Odds + 1}}$$\n\n## Likelihood ratios\n\n<br>\n\nOdds favoring an event; Odds = p/(1-p) If an event has 0.20 probability\nof occurrence, the odds favoring the event = 0.2/0.8 = 0.25 (or 1:4)\n\n<br>\n\nOdds against (OddA) the event; OddA = (1-p)/p The odds against are\n0.8/0.2 = 4 (or 4:1)\n\n::: notes\nThe components of the LR are calculated vertically, and like the\nsensitivity and specificity are immune to the prevalence\n:::\n\n## Back to first example (coronary care unit)\n\n<br>\n\n::: {style=\"font-size: 0.6em\"}\n|                | *Present*   | *Absent*    |                     |\n|----------------|-------------|-------------|---------------------|\n| *Elevated (+)* | 300 (a, TP) | 15 (b, FP)  | 315 (a + b)         |\n| *Normal (-)*   | 35 (c, FN)  | 150 (d, TN) | 185 (c + d)         |\n|                | 335 (a + c) | 165 (b + d) | 500 (a + b + c + d) |\n:::\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n-   Pre-test probability was 67% (prevalence)\n-   SENS = 0.90 & SPEC = 0.91\n-   LR+ (for positive test result) = SENS / 1=SPEC = 0.90/1-0/.91 =\n    **10**\n-   Interpretation: A patient with a positive test result is 10X more\n    likely to have had a heart attack than someone who did not have a\n    heart attack with the same test result\n:::\n\n::: notes\n(1) Let's go back to our 1st example when we were looking at a coronary\n    care unit population\n(2) The pre-test probability was 67%\n(3) Sensitivity was 90% & specificity was 91%\n(4) The Likelihood ratio for a positive test result would be, SENS /\n    1-SPEC (or, true positive divided by false positives) = 10 This\n    means...\n:::\n\n## Back to first example (coronary care unit)\n\n<br>\n\n-   LR - (for a negative test result):\n    -   1-SENS / SPEC = 1-0.90 / 0.91 = **.11**, indicates a \\~10-fold\n        decrease in the odds of having a condition in a patient with a\n        negative test result.\n\n::: notes\n(1) The Likelihood ratio for a NEGATIVE test result would be, (false\n    negative tests / true negative)\n:::\n\n## Back to first example (coronary care unit)\n\n<br>\n\n::: columns\n::: {.column width=\"90%\"}\n::: {style=\"font-size: 0.6em\"}\n|                                                                     |                         |\n|-----------------------------------------------------------------------------------------------|\n| Pre-test probability                                                | 67%                     |\n| Pre-test odds (0.67 / 1-0.67)                                       | 2 (2:1)                 |\n| Post (+ test) odds of disease  = pre-test odds \\* LR(+)             | 2\\*10 = 20.             |\n| Post (+ test) prob of disease = post-test odds / post-test odds + 1 | = 20/21 = 0.95 (PPV)    |\n| Post (- test) odds of disease = pre-test odds \\* LR(-)              | = 2\\*0.11 = 0.22        |\n| Post (- test) prob of disease = 0.22 / 1.22                         | = 0.18 (1-NPV)          |\n:::\n:::\n:::\n\n::: notes\n(1) Now let's calculate the pre & post-test ODDS using what we found the\n    LR's to be\n\n(2) Pre-test odds = Prob / 1-Prob = 2 ; In other words, \\[2:1\\] - If you\n    play the game 3 times, you're likely to win twice\n\n(3) Post-test odds = pre-test odds \\* LR\n\n-   Post-test odds of a POSITIVE test = 2\\*10 (10 is the value we got a\n    couple slides back) = 20 ; or 20-fold increase in odds\n\n-   Post-test probability of a POSITIVE test = 95%, which is the\n    probability that your patient will have a heart attack given his/her\n    screening test results (worthwhile diagnostic test)\n\n-   Post-test odds of a NEGATIVE test = 0.22; 20-fold decrease in odds\n    of having a heart attack in a patient with a negative test result\n\n-   Post-test probability of a NEGATIVE test = 18% ; in other words, of\n    those with normal levels, there is an 18% prob that your patient\n    WILL HAVE a heart attack given the negative screening results\n:::\n\n## Odds Likelihood Form of Bayes\n\n::: {style=\"font-size: 0.8em\"}\n$$\nOdds LR = \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} = \\frac{{Pr(D+)}}{Pr(D-)} * \\frac{{lr(D+)}}{lr(D-)}\n$$ <br>\n\n$$ \\frac{{Pr(D+)}}{Pr(D-)} * \\frac{{lr(D+)}}{lr(D-)}$$ <br>\n\nThe above is the same as:\n\n$$ \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} $$\n:::\n\n## Odds Likelihood Form of Bayes\n\n::: {style=\"font-size: 0.8em\"}\n$$\nOdds LR = \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} = \\frac{{Pr(D+)}}{Pr(D-)} * \\frac{\\text{Pr(test result | D+)}}{\\text{Pr (test result | D-)}}\n$$ <br>\n\nPre-test odds favoring disease (*the prior*):\n\n$$ \\frac{{Pr(D+)}}{Pr(D-)} $$\n\n<br> The post-test odds given the test result:\n\n$$ \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} $$\n:::\n\n## Odds Likelihood Form of Bayes\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n$$\n\\frac{\\text{Pr(test result | D+)}}{\\text{Pr (test result | D-)}} = \\frac{{Pr(D-)}}{{Pr (D+)}} * \\frac{{(CTN - CFP)}}{(CTP - CFN)} \n$$ <br>\n\nHow to calculate an optimal \"cut-off\" for a test with categorical or\ncontinuous results at the point in which we will [optimize the cut-off\nconditional on the (1) prior probability of disease and (2) the\nconsequences of the scenario we are assessing]{style=\"color: green;\"}\n\n<br>\n\nNext lecture: [Positivity Criterion!]{style=\"color: green;\"}\n:::\n\n::: notes\n-   You won't be tested on this equation, but this is another way of getting the OPTIMAL CUT-OFF VALUE for a continuous or categorical test -- remember this for the next lecture on positivity criterion. \n\n-   Need to factor in the \"interventions/treatment\" for the \"consequences of false positive\" and \"consequences of false negative\"\n:::\n\n## Likelihood ratios\n\n<br>\n\n::: {.callout-important appearance=\"simple\"}\nLR (+) <br> GT 10 Excellent <br> 5-10 Good <br> 2-5 Fair. May be helpful\n<br> 1-2 Unlikely to be helpful\n:::\n\n::: {.callout-important appearance=\"simple\"}\nLR (-) <br> \\<0.1 Excellent <br> 0.1-0.2 Good <br> 0.2-0.5 Fair. May be\nhelpful <br> 0.5-1.0 Unlikely to be helpful\n:::\n\n::: notes\n(1) The higher **diagnostic odds ratios** are indicative of better test\n    performance, which you can see here\n:::\n\n","srcMarkdownNoYaml":"\n\n# Learning Objectives and Outline\n\n## Learning Objectives\n\n-   Recognize the importance of Bayes' Theorem within a Decision\n    Analysis context\n\n-   Reproduce Bayes' within context of sensitivity/specificity/positive\n    & negative predictive values\n\n\n## Medical Testing\n\n<br>\n\n**Testing is done for:**\n\n-   Screening (primary prevention)\n\n-   Diagnosis (secondary prevention)\n\n-   Monitor and guide treatment (tertiary prevention)\n\n-   Prognosis\n\n::: notes\nKeeping Bayes' Theorem in mind, let's jump into diagnostic testing &\nthen we will see how we would apply Bayes' theorem within the context of\ntest results\n\nMEDICAL TESTING is done for --\n\nScreening as it relates to primary prevention EX: HPV screening for\ncervical cancer prevention\n\nDiagnosis, or secondary prevention EX: Diagnosis of Hepatitis C, which\nthe earlier diagnosis the better in terms of the disease getting worse\nover time\n\nTo monitor & guide treatment (otherwise known as tertiary prevention)\nEX: Diabetes could be a good example of this -- the goal is to improve\nquality of life by limiting or delaying complications, restoring\nfunction, etc.\n\nTo make a prognosis EX: The likely course of a disease\n:::\n\n## Information for decision making\n\n<br>\n\n**Clinicians have a variety of diagnostic information to guide their\ndecision making**\n\n-   Talking to patient (history, symptoms)\n\n-   Physically examining patient\n\n-   Screening (cervical cancer) + diagnostic tests (EKGs, Blood tests,\n    X-rays)\n\n## Information for decision making\n\n<br>\n\nObtaining information can be...\n\n::: incremental\n-   RISKY <br>\n\n-   EXPENSIVE <br>\n\n-   ERROR PRONE <br>\n\n-   ALL THREE\n:::\n\n::: notes\nRISKY/INVASIVE -- For example, getting an Amniocentesis during pregnancy\n(A medical procedure used primarily in prenatal diagnosis of chromosomal\nabnormalities and fetal infections) can significantly increase one's\nrisk of a miscarriage.\n\nEXPENSIVE -- An MRI, for example, is pricey\n\nERROR PRONE -- Diagnostic tests, like anything, aren't perfect; though,\nsome are more perfect than others\n\nALL THREE --A diagnostic test, for example, could be all three -- risky,\nexpensive, & not very precise\n\n\\*\\*We need to factor in these tradeoffs when making decisions\n:::\n\n## Role of Decision Analysis Methods\n\n- Can be used to weigh the costs and benefits: \n  - Test costs\n  - Test accuracy\n  - Health risks of testing\n\n## Example: Diagnostic Tests\n\nWhat is the chance that a patient has a disease if a diagnostic test is positive\nor negative? <br>\n\n\n## Example: Diagnostic Tests\n\nWhat is the chance that a patient has a disease if a diagnostic test is positive\nor negative? <br>\n\nIn other words, what is the probability of disease conditional on the\ntest result? (D+ \\| T+); (D+ \\| T-)\n\n## Ways to get revised (posterior) probabilities\n\n\n<br>\n\n1.  Bayes' theorem <br>\n2.  2x2 tables <br>\n3.  Bayes' theorem via decision tree inversion  <br>\n\n## Ways to get revised (posterior) probabilities\n\n::: nonincremental\n<br>\n\n1.  [Bayes' theorem]{style=\"background-color: yellow;\"}  <br>\n2.  2x2 tables <br>\n3.  Bayes' theorem via decision tree inversion  <br>\n\n:::\n\n# 1. Bayes' Theorem: Intuition {background=\"#43464B\"}\n\n## Population of 200 indiviudals\n\n\n![](images/bayes_test1.png){height=600 fig-align=\"center\"}\n\n\n## Disease (red) has 1% prevalence.\n\n\n![](images/bayes_test2.png){height=600 fig-align=\"center\"}\n\n\n## A Screening Test is Available\n\n::: {layout=\"[[-1], [-1], [1], [-1]]\"}\n![](images/bayes_test.png){height=100 fig-align=\"center\"}\n:::\n\n\n## Test will detect 100% of positive cases.\n\n![](images/bayes_test3a.png){height=600 fig-align=\"center\"}\n\n\n## 3% of disease-free individuals will test positive {.smaller}\n\n![](images/bayes_test3.png){height=520 fig-align=\"center\"}\n\n\n## Eight Positive Tests\n\n\\vspace{4em}\n\n::: {layout=\"[[-1],[-1], [-1], [1], [-1]]\"}\n\n![](images/bayes_test4.png){height=100 fig-align=\"center\"}\n:::\n\n## Probability of Disease Given Positive Test\n\n::: {layout=\"[[-1],[-1],  [1], [-1]]\"}\n\n![](images/bayes_test5.png){height=80% fig-align=\"center\"}\n:::\n\n## Key Points\n\n- While the test *always* detects a true case, it also returns false positives.\n- The higher the number of false positives, the lower the probability that a given positive result is actually an individual with the disease.\n\n## False Positives\n\n- Could be the result of a poor test (e.g., 3% false positive rate).\n- Or could be the result of a disease with very low prevalence in a large population, but a very good test!\n  - In a population of 200 million, a test with a 0.01% false positive rate will yield 20,000 false positive readings!\n  - If the disease prevalence is low (e.g., 0.001%, or 2,000 sick individuals), the probability that someone is sick if they test positive is <10%!\n\n\n# Bayes' Theorem: Theory {background=\"#43464B\"}\n\n## Probability of B\n\n::: columns\n::: {.column}\n$$\nPr(B) \n$$\n:::\n::: {.column}\n![](images/conditional-1.png)\n:::\n:::\n\n## Probability of A and B\n\n::: columns\n::: {.column width=\"60%\"}\n$$\n\\begin{aligned}\nPr(A \\& B) &= Pr(A|B) Pr(B)\\\\\n&= Pr(B|A) Pr(A)\n\\end{aligned}\n$$\n:::\n::: {.column width=\"30%\"}\n![](images/conditional-2.png)\n:::\n:::\n\n\n\n## Probability of A Given B\n\n::: columns\n::: {.column}\n$$\nPr(A|B) = \\frac{Pr(A \\& B)}{Pr(B)}\n$$\n:::\n::: {.column}\n![](images/conditional-3.png)\n:::\n:::\n\n\n\n\n\n## A Perfect Test\n\n![](images/bayes1.png){height=600 fig-align=\"center\"}\n\n## 100% Specificity, <100% Sensitivity\n\n![](images/bayes2.png){height=600 fig-align=\"center\"}\n\n## <100% Specificity, 100% Sensitivity\n\n![](images/bayes3.png){height=600 fig-align=\"center\"}\n\n\n## Let's Lower Disease Prevalence\n\n![](images/bayes4.png){height=600 fig-align=\"center\"}\n\n## <100% Specificity, <100% Sensitivity\n\n![](images/bayes5.png){height=600 fig-align=\"center\"}\n\n# What is the Probability of Disease Given A Positive Test? {background=\"#43464B\"}\n\n## Probability of Testing Positive if Have Disease\n\n::: columns\n\n::: {.column}\n::: {layout=\"[[-1],  [1], [-1]]\"}\n![](images/bayes5.png){height=250 fig-align=\"center\"}\n:::\n:::\n\n::: {.column}\n::: {layout=\"[[-1], [-1], [1], [-1]]\"}\n\n![](images/bayes_PrPosBarDisesase.png){height=50 fig-align=\"center\"}\n:::\n:::\n:::\n\n\n## Probability of Having the Disease\n\n::: columns\n\n::: {.column}\n::: {layout=\"[[-1],  [1], [-1]]\"}\n![](images/bayes5.png){height=300 fig-align=\"center\"}\n:::\n:::\n\n::: {.column}\n\n![](images/bayes_PrDisease.png){height=300 fig-align=\"center\"}\n:::\n\n:::\n## Probability of a Positive Test\n\n::: columns\n\n::: {.column}\n::: {layout=\"[[-1],  [1], [-1]]\"}\n![](images/bayes5.png){height=300 fig-align=\"center\"}\n:::\n:::\n\n\n::: {.column}\n![](images/bayes_PrPos.png){height=300 fig-align=\"center\"}\n:::\n:::\n\n## Bayes' Theorem\n\n::: columns\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_theorem_.png)\n:::\n:::\n\n:::{.column}\n![](images/bayes_theorem.png){fig-align=\"center\" height=\"600px\"}\n:::\n\n:::\n\n\n::: notes\n(1) Bayes theorem describes the probability of an event BASED ON the\n    PRIOR knowledge of conditions that might be related to the event\n\n(2) When conducting decision analyses in real life, sometimes, the\n    probability of A given B is easier to get (or vice versa) and you're\n    not able to find the probability of B given A. So, you can use\n    Bayes' theorem to convert probabilities into what you need based on\n    the data you have in the real world\n\n(3) Conditional probabilities are related according to Bayes' theorem --\n    in other words, it is a way to RELATE conditional probabilities\n\n(4) Explain how to get to Bayes equation\\*\\*\\* NOTE: Pr(B) cannot be 0\n    and Pr(A) cannot be 0 or it becomes undefined\n:::\n\n## {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\"}\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population0.png)\n:::\n:::\n\n\n:::\n\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population1.png)\n:::\n\n:::\n\n\n\n:::\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population2.png)\n:::\n\n:::\n\n\n\n:::\n\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population3.png)\n:::\n\n:::\n\n\n\n:::\n\n##  {background-image=\"images/bayes_test3.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n::: columns\n\n:::{.column}\n::: nonincremental\n- Population of 200\n- Disease (red) has 1% prevalence.\n- Test will detect 100% of positive cases.\n- 3% of disease-free individuals will test positive \n:::\n:::\n\n:::{.column}\n::: {layout=\"[[-1], [-1],[-1], [1], [-1]]\"}\n![](images/bayes_population3.png)\n![](images/bayes_population4.png)\n:::\n\n:::\n\n\n\n:::\n\n# 2. 2x2 Tables {background=\"#43464B\"}\n\n## 2x2 Example: Disease Testing\n\n**Case example**\n\nYou are trying to determine what proportion of the\npopulation has already been exposed a new communicable disease, in hopes of figuring out\nif herd immunity is possible.\n\n<br>\n\nYou decide to do a  antibody test to measure the level of\nantibodies [in a sample of 500 participants]{style=\"background-color: yellow;\"}\n\n## Disease Testing\n\n<br>\n\n**Case example**\n\nWhat is the test's SENSITIVITY? <br>\n\nWhat is the test's SPECIFICITY? <br>\n\nWhat is the test's FALSE NEGATIVE RATE? <br>\n\nWhat is the test's FALSE POSITIVE RATE? <br>\n\n## Disease Testing\n\n<br>\n\n**Case example**\n\n::: {style=\"font-size: 0.8em\"}\n|      | *D+*   | *D-*   |               |\n|------|--------|--------|---------------|\n| *T+* | a (TP) | b (FP) | a + b         |\n| *T-* | c (FN) | d (TN) | c + d         |\n|      | a + c  | b + d  | a + b + c + d |\n:::\n\n::: notes\nOne way we can look at these different testing outcomes is through a 2X2\ntable\n:::\n\n## Disease Testing: SENSITIVITY\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n|      | *D+*            | *D-*        |                     |\n|------|-----------------|-------------|---------------------|\n| *T+* | **125** (a, TP) | 20 (b, FP)  | 145 (a + b)         |\n| *T-* | 9 (c, FN)       | 346 (d, TN) | 355 (c + d)         |\n|      | **134** (a + c) | 366 (b + d) | 500 (a + b + c + d) |\n:::\n\n<br> Test Sensitivity among those who have or had the virus, [125/134 =\n93%]{style=\"background-color: yellow;\"} (Interpretation: The probability\nof the screening test correctly identifying diseased subjects was 93%)\n\n::: notes\n(1) **Sensitivity** measures how often a test correctly generates a\n    positive result for people who had the condition that's being tested\n    for (also known as the \"true positive\" rate).\n\n(2) We would take column A (which is the proportion of people who have a\n    positive COVID antibody test & divide that by everyone who truly had\n    COVID) --\n\n(3) As a result, we would get the proportion of people that previously\n    HAD COVID with a TRUE POSITIVE test\n\n*(to determine those who \"truly\" had COVID, the study criteria could\nhave included individuals who had received a range of other confirmatory\ntests while they had COVID, including lung examinations, other blood\nwork, etc.)*\n\n(4) For this example, we get a test sensitivity of 93%\n\n(5) **In other words, a test with 93% sensitivity will correctly return\n    a positive result for MOST people who have had COVID BUT will return\n    a negative result --- a false-negative --- for 7% of the people who\n    have had COVID & should have tested positive**\n:::\n\n## Disease Testing: SENSITIVITY\n\n![](images/sensitivity.png)\n\n## Example: SPECIFICITY\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n|      | *D+*        | *D-*            |                     |\n|------|-------------|-----------------|---------------------|\n| *T+* | 125 (a, TP) | 20 (b, FP)      | 145 (a + b)         |\n| *T-* | 9 (c, FN)   | **346** (d, TN) | 355 (c + d)         |\n|      | 134 (a + c) | **366** (b + d) | 500 (a + b + c + d) |\n:::\n\n<br> Test Specificity among those without the disease at any point,\n[346/366 = 95%]{style=\"background-color: yellow;\"} (Interpretation: The\nprobability of the screening test correctly identifying non-diseased\nsubjects was 65%)\n\n::: notes\n(1) **Specificity** measures a test's ability to correctly generate a\n    **negative result** for people **who don't have the condition** (or\n    didn't have the condition in our case) that's being tested for (also\n    known as the \"true negative\" rate).\n\n(2) To calculate the SPECIFICITY of the antibody test, we would take\n    column D (which is the proportion of people who tested negative for\n    COVID antibodies & divide that by everyone who **truly** did NOT\n    have COVID\n\n(3) When we do the calculation, the probability of the antibody test\n    correctly identifying those that DID NOT previously have COVID was\n    95%\n\n(4) **In other words, a test with 95% specificity will correctly return\n    a negative result for MOST people who didn't have the disease BUT\n    will return a positive result --- a false-positive --- for 5% of the\n    people who didn't have COVID and should have tested negative for the\n    antibodies**\n:::\n\n\n## Disease Testing: SPECIFICITY\n\n![](images/specificity.png)\n\n# Do you want a test with good Sensitivity or good Specificity? {background=\"#43464B\"}\n\n::: notes\nIT DEPENDS!\n\nEXAMPLE -- HIV TEST\n\nIf low SENSITIVITY, you have the risk of producing a lot of\nfalse-negatives, which could be bad for the population & the spread of\nthe virus + patient not getting the care he/she needs; Not picking up\nthe disease in people who should be picked up\n\nIf low SPECIFICITY, there's an increase risk of false-positive results,\nwhich can be devastating & lead to toxicity implications (if you start\ntreatment) + grave emotional consequences + increase healthcare costs\nFalsely returning positive tests in people that don't have the disease\n:::\n\n## False Negatives\n\n<br>\n\n[False negative rate (1-sensitivity)]{style=\"color: #169873;\"} is the\nproportion of diseased people with a negative test: c/(a+c)\n\n## False Negatives{background-image=\"images/false-negative.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n<br>\n\n[False negative rate (1-sensitivity)]{style=\"color: #169873;\"} is the\nproportion of diseased people with a negative test: c/(a+c)\n\n## False Negatives{background-image=\"images/false-negative.png\" data-background-size=\"contain\" background-opacity=\"1.0\"}\n \n \n\n## False Positives\n\n<br>\n\n[False positive rate (1-specificity)]{style=\"color: #169873;\"} is the\nproportion of non-diseased people with a positive test: b/(b+d)\n\n## False Negatives{background-image=\"images/false-positive.png\" data-background-size=\"contain\" background-opacity=\"0.1\"}\n\n<br>\n\n[False positive rate (1-specificity)]{style=\"color: #169873;\"} is the\nproportion of non-diseased people with a positive test: b/(b+d)\n\n## False Negatives{background-image=\"images/false-positive.png\" data-background-size=\"contain\" background-opacity=\"1.0\"}\n\n# Bayes' Theorem With Tree Inversion {background=\"#43464B\"}\n\n## Bayes' theorem with tree inversion\n\n![](images/inversion1.png){fig-align=\"center\" height=\"400px\"}\n\n::: notes\n-   Another way that we can revise probabilities based on the\n    information we have to work with is inverting the tree\n\n-   We often have information on the P(T+ \\| D+) (tree to the right);\n    but mathematically, the tree to the left is the same, but it might\n    be easier to construct the tree this way given the information you\n    have\n:::\n\n## Goal: \"Flip\" The Tree\n\n![](images/inversion2.png){fig-align=\"center\" height=\"600px\"}\n\n## Start Matching Terminal Numbers ... \n\n![](images/inversion3.png){fig-align=\"center\" height=\"600px\"}\n\n## Continue Matching Terminal Numbers ... \n\n![](images/inversion4.png){fig-align=\"center\" height=\"600px\"}\n\n## Continue Matching Terminal Numbers ... \n\n![](images/inversion5.png){fig-align=\"center\" height=\"600px\"}\n\n## Work Your Way Down the Tree ... \n\n![](images/inversion6.png){fig-align=\"center\" height=\"600px\"}\n\n## Inverted Tree\n\n![](images/inversion7.png){fig-align=\"center\" height=\"600px\"}\n\n## Probability of Disease Given + Test\n\n![](images/inversion8.png){fig-align=\"center\" height=\"600px\"}\n\n## Probability of Disease Given - Test\n\n![](images/inversion9.png){fig-align=\"center\" height=\"600px\"}\n\n## Conclusions\n\n::: incremental\n-   We are often bayesian in how we think\n-   Knowledge of test characteristics can help you to make more informed\n    decisions\n-   In general, diagnostic tests are helpful when pre-test prob is in\n    the middle (30-70%) and test is going to move you past a decision\n    threshold\n-   Tests with very good characteristics (ex. 100% sens or spec) can\n    also be very useful if used appropriately\n:::\n\n::: notes\n(1) You don't realize it but you're already thinking about these ratios\n    in your head\n\n-   If you're a surgeon and someone comes in and says that their stomach\n    hurts, you have a certain probability in your mind that they have\n    appendicitis\n-   Everyday life and other professions -- Personality tests, who will\n    benefit from education intervention; Autism screening\n\n(2) Pre-test probability is a big deal because you don't want to do an\n    expensive test with a low pre-test probability, BUT once you find\n    additional information then that can change\n:::\n\n\n# [Extra] Likelihood Ratios {background=\"#43464B\"}\n\n## Likelihood ratio\n\n<br>\n\n::: {.callout-important appearance=\"minimal\" icon=\"false\"}\nUseful for situations in which a quick estimate of revised probabilities\nis needed\n:::\n\n> Likelihood that a given test result would be expected in a patient\n> with the **target disorder Pr(test result \\| D+) compared to** the\n> likelihood that the same result would be expected in a patient\n> **without the target disorder Pr(test result \\| D-)** \\[A RATIO\\]\n\n## Likelihood ratios\n\n<br>\n\nThe likelihood ratio (LR) summarizes test sensitivity and specificity\n[into one number:]{style=\"color: forestgreen;\"} <br>\n\n::: {.callout-important appearance=\"minimal\" icon=\"false\"}\nLR (positive test) = sensitivity/1-specificity (or TPR/FPR)\n:::\n\n::: {.callout-important appearance=\"minimal\" icon=\"false\"}\nLR (negative test) = 1-sensitivity/specificity (or FNR/TNR)\n:::\n\n## Likelihood ratios\n\n-   LR can be used to revise disease probabilities using the following\n    form of Bayes' Theorem:\n\n> Post-test odds = Pretest odds x LR\n\n-   The odds that the patient has the target disorder, after the test\n    results are known. It is calculated by multiplying the pre-test odds\n    by the likelihood of a positive or negative test.\n\n::: notes\n(3) In other words, the post-test odds are the odds that the patient has\n    the target disorder AFTER the test results are known\n:::\n\n## Likelihood ratios\n\n<br>\n\n-   LR's are an advance beyond 2x2 tables\n\n-   To use likelihood ratios, you must be comfortable converting between\n    probabilities of disease and odds of disease\n\n-   Odds are simply another way of describing the chances that something\n    will (or won't) happen\n\n## Likelihood ratios\n\n<br>\n\n$$ Odds of Disease = \\frac{\\text{Probability}}{\\text{1 - Probability}}$$\n<br>\n\n$$ Probability = \\frac{\\text{Odds}}{\\text{Odds + 1}}$$\n\n## Likelihood ratios\n\n<br>\n\nOdds favoring an event; Odds = p/(1-p) If an event has 0.20 probability\nof occurrence, the odds favoring the event = 0.2/0.8 = 0.25 (or 1:4)\n\n<br>\n\nOdds against (OddA) the event; OddA = (1-p)/p The odds against are\n0.8/0.2 = 4 (or 4:1)\n\n::: notes\nThe components of the LR are calculated vertically, and like the\nsensitivity and specificity are immune to the prevalence\n:::\n\n## Back to first example (coronary care unit)\n\n<br>\n\n::: {style=\"font-size: 0.6em\"}\n|                | *Present*   | *Absent*    |                     |\n|----------------|-------------|-------------|---------------------|\n| *Elevated (+)* | 300 (a, TP) | 15 (b, FP)  | 315 (a + b)         |\n| *Normal (-)*   | 35 (c, FN)  | 150 (d, TN) | 185 (c + d)         |\n|                | 335 (a + c) | 165 (b + d) | 500 (a + b + c + d) |\n:::\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n-   Pre-test probability was 67% (prevalence)\n-   SENS = 0.90 & SPEC = 0.91\n-   LR+ (for positive test result) = SENS / 1=SPEC = 0.90/1-0/.91 =\n    **10**\n-   Interpretation: A patient with a positive test result is 10X more\n    likely to have had a heart attack than someone who did not have a\n    heart attack with the same test result\n:::\n\n::: notes\n(1) Let's go back to our 1st example when we were looking at a coronary\n    care unit population\n(2) The pre-test probability was 67%\n(3) Sensitivity was 90% & specificity was 91%\n(4) The Likelihood ratio for a positive test result would be, SENS /\n    1-SPEC (or, true positive divided by false positives) = 10 This\n    means...\n:::\n\n## Back to first example (coronary care unit)\n\n<br>\n\n-   LR - (for a negative test result):\n    -   1-SENS / SPEC = 1-0.90 / 0.91 = **.11**, indicates a \\~10-fold\n        decrease in the odds of having a condition in a patient with a\n        negative test result.\n\n::: notes\n(1) The Likelihood ratio for a NEGATIVE test result would be, (false\n    negative tests / true negative)\n:::\n\n## Back to first example (coronary care unit)\n\n<br>\n\n::: columns\n::: {.column width=\"90%\"}\n::: {style=\"font-size: 0.6em\"}\n|                                                                     |                         |\n|-----------------------------------------------------------------------------------------------|\n| Pre-test probability                                                | 67%                     |\n| Pre-test odds (0.67 / 1-0.67)                                       | 2 (2:1)                 |\n| Post (+ test) odds of disease  = pre-test odds \\* LR(+)             | 2\\*10 = 20.             |\n| Post (+ test) prob of disease = post-test odds / post-test odds + 1 | = 20/21 = 0.95 (PPV)    |\n| Post (- test) odds of disease = pre-test odds \\* LR(-)              | = 2\\*0.11 = 0.22        |\n| Post (- test) prob of disease = 0.22 / 1.22                         | = 0.18 (1-NPV)          |\n:::\n:::\n:::\n\n::: notes\n(1) Now let's calculate the pre & post-test ODDS using what we found the\n    LR's to be\n\n(2) Pre-test odds = Prob / 1-Prob = 2 ; In other words, \\[2:1\\] - If you\n    play the game 3 times, you're likely to win twice\n\n(3) Post-test odds = pre-test odds \\* LR\n\n-   Post-test odds of a POSITIVE test = 2\\*10 (10 is the value we got a\n    couple slides back) = 20 ; or 20-fold increase in odds\n\n-   Post-test probability of a POSITIVE test = 95%, which is the\n    probability that your patient will have a heart attack given his/her\n    screening test results (worthwhile diagnostic test)\n\n-   Post-test odds of a NEGATIVE test = 0.22; 20-fold decrease in odds\n    of having a heart attack in a patient with a negative test result\n\n-   Post-test probability of a NEGATIVE test = 18% ; in other words, of\n    those with normal levels, there is an 18% prob that your patient\n    WILL HAVE a heart attack given the negative screening results\n:::\n\n## Odds Likelihood Form of Bayes\n\n::: {style=\"font-size: 0.8em\"}\n$$\nOdds LR = \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} = \\frac{{Pr(D+)}}{Pr(D-)} * \\frac{{lr(D+)}}{lr(D-)}\n$$ <br>\n\n$$ \\frac{{Pr(D+)}}{Pr(D-)} * \\frac{{lr(D+)}}{lr(D-)}$$ <br>\n\nThe above is the same as:\n\n$$ \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} $$\n:::\n\n## Odds Likelihood Form of Bayes\n\n::: {style=\"font-size: 0.8em\"}\n$$\nOdds LR = \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} = \\frac{{Pr(D+)}}{Pr(D-)} * \\frac{\\text{Pr(test result | D+)}}{\\text{Pr (test result | D-)}}\n$$ <br>\n\nPre-test odds favoring disease (*the prior*):\n\n$$ \\frac{{Pr(D+)}}{Pr(D-)} $$\n\n<br> The post-test odds given the test result:\n\n$$ \\frac{\\text{Pr(D+ | test result)}}{\\text{Pr(D- | test result)}} $$\n:::\n\n## Odds Likelihood Form of Bayes\n\n<br>\n\n::: {style=\"font-size: 0.8em\"}\n$$\n\\frac{\\text{Pr(test result | D+)}}{\\text{Pr (test result | D-)}} = \\frac{{Pr(D-)}}{{Pr (D+)}} * \\frac{{(CTN - CFP)}}{(CTP - CFN)} \n$$ <br>\n\nHow to calculate an optimal \"cut-off\" for a test with categorical or\ncontinuous results at the point in which we will [optimize the cut-off\nconditional on the (1) prior probability of disease and (2) the\nconsequences of the scenario we are assessing]{style=\"color: green;\"}\n\n<br>\n\nNext lecture: [Positivity Criterion!]{style=\"color: green;\"}\n:::\n\n::: notes\n-   You won't be tested on this equation, but this is another way of getting the OPTIMAL CUT-OFF VALUE for a continuous or categorical test -- remember this for the next lecture on positivity criterion. \n\n-   Need to factor in the \"interventions/treatment\" for the \"consequences of false positive\" and \"consequences of false negative\"\n:::\n\n## Likelihood ratios\n\n<br>\n\n::: {.callout-important appearance=\"simple\"}\nLR (+) <br> GT 10 Excellent <br> 5-10 Good <br> 2-5 Fair. May be helpful\n<br> 1-2 Unlikely to be helpful\n:::\n\n::: {.callout-important appearance=\"simple\"}\nLR (-) <br> \\<0.1 Excellent <br> 0.1-0.2 Good <br> 0.2-0.5 Fair. May be\nhelpful <br> 0.5-1.0 Unlikely to be helpful\n:::\n\n::: notes\n(1) The higher **diagnostic odds ratios** are indicative of better test\n    performance, which you can see here\n:::\n\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":"katex","slide-level":2,"to":"revealjs","incremental":true,"highlight-style":"ayu-mirage","output-file":"lec_3a.bayes-probrevision.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":false,"quarto-version":"1.8.24","auto-stretch":true,"title":"Bayes’ Theorem & Probability Revision","editor_options":{"chunk_output_type":"console"},"editor":"source","theme":"slides.scss","slideNumber":true,"logo":"../vchem.png","transition":"fade","backgroundTransition":"fade","footer":"[Back to Website](../index.html)\n"}}},"projectFormats":["html"]}